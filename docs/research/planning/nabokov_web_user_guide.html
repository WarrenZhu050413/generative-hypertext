<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nabokov Web Clipper - Complete User Guide</title>
    <style>
        :root {
            --chinese-red: #8B0000;
            --chinese-gold: #FFD700;
            --paper-beige: #F5F5DC;
            --light-cream: #FFFEF0;
            --ink-black: #2C2C2C;
            --level-1: #8B0000;
            --level-2: #A52A2A;
            --level-3: #B8860B;
            --level-4: #666;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, var(--paper-beige) 0%, var(--light-cream) 100%);
            color: var(--ink-black);
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro', 'Segoe UI', Roboto, Arial, sans-serif;
            line-height: 1.3;
            font-size: 14px;
            width: 100vw;
            max-width: 100%;
            padding: 0;
            margin: 0;
        }

        .container {
            width: 100%;
            padding: 12px;
        }

        h1 {
            font-size: 28px;
            font-weight: 900;
            margin: 8px 0 12px 0;
            padding: 8px 4px;
            background: linear-gradient(135deg, var(--chinese-red), #CD5C5C);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
            text-align: center;
        }

        h2 {
            font-size: 18px;
            font-weight: 700;
            margin: 12px 0 6px 0;
            padding: 6px 8px;
            border-left: 4px solid var(--chinese-red);
            background: rgba(139, 0, 0, 0.05);
            color: var(--level-1);
        }

        h3 {
            font-size: 15px;
            font-weight: 600;
            margin: 8px 0 4px 8px;
            color: var(--level-2);
        }

        h4 {
            font-size: 13px;
            font-weight: 600;
            margin: 4px 0 2px 16px;
            color: var(--level-3);
        }

        .intro {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), white);
            border: 2px solid var(--chinese-gold);
            padding: 12px;
            margin: 12px 0;
            border-radius: 4px;
            text-align: center;
        }

        .intro p {
            margin: 6px 0;
            font-size: 15px;
        }

        .citation {
            font-size: 12px;
            color: var(--level-4);
            font-style: italic;
            margin-top: 8px;
        }

        .collapsible {
            margin: 6px 0;
            width: 100%;
        }

        .collapsible-header {
            cursor: pointer;
            padding: 8px 12px;
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.06), rgba(255, 215, 0, 0.03));
            border-left: 3px solid var(--chinese-gold);
            display: flex;
            align-items: center;
            justify-content: space-between;
            user-select: none;
            transition: all 0.2s ease;
            font-weight: 600;
        }

        .collapsible-header:hover {
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.12), rgba(255, 215, 0, 0.06));
        }

        .collapsible-header .arrow {
            display: inline-block;
            transition: transform 0.3s ease;
            color: var(--chinese-red);
            font-size: 12px;
            margin-right: 8px;
        }

        .collapsible.open .arrow {
            transform: rotate(90deg);
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease;
            padding: 0 12px;
            margin-left: 12px;
        }

        .collapsible.open .collapsible-content {
            max-height: 8000px;
            padding: 12px;
        }

        .collapsible.critical .collapsible-header {
            border-left: 4px solid var(--chinese-red);
            background: rgba(139, 0, 0, 0.1);
            font-weight: 700;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin: 8px 0;
        }

        .card {
            background: white;
            border: 1px solid rgba(139, 0, 0, 0.2);
            border-radius: 3px;
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
        }

        .card.highlight {
            border: 2px solid var(--chinese-gold);
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.08), white);
        }

        .card h4 {
            margin: 0 0 6px 0;
            color: var(--chinese-red);
        }

        code {
            background: rgba(245, 245, 220, 0.4);
            border: 1px solid rgba(139, 0, 0, 0.15);
            padding: 2px 6px;
            border-radius: 2px;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
            font-size: 13px;
        }

        kbd {
            background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
            border: 1px solid #999;
            border-radius: 3px;
            padding: 2px 6px;
            font-family: inherit;
            font-size: 12px;
            font-weight: 600;
            box-shadow: 0 1px 2px rgba(0,0,0,0.15);
        }

        ul, ol {
            margin: 6px 0 6px 20px;
        }

        li {
            margin: 4px 0;
            line-height: 1.4;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 12px;
            margin: 12px 0;
        }

        .shortcut-table {
            width: 100%;
            border-collapse: collapse;
            margin: 8px 0;
            font-size: 13px;
        }

        .shortcut-table th,
        .shortcut-table td {
            border: 1px solid rgba(139, 0, 0, 0.2);
            padding: 6px 10px;
            text-align: left;
        }

        .shortcut-table th {
            background: rgba(139, 0, 0, 0.1);
            font-weight: 600;
            color: var(--level-1);
        }

        .shortcut-table tr:nth-child(even) {
            background: rgba(245, 245, 220, 0.2);
        }

        .tip {
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.05), rgba(255, 215, 0, 0.05));
            border-left: 3px solid var(--chinese-gold);
            padding: 8px 12px;
            margin: 8px 0;
            font-size: 13px;
        }

        .tip strong {
            color: var(--chinese-red);
        }

        .workflow {
            background: white;
            border: 2px solid var(--chinese-red);
            padding: 12px;
            margin: 8px 0;
            border-radius: 4px;
        }

        .workflow-step {
            display: flex;
            align-items: flex-start;
            margin: 6px 0;
        }

        .workflow-number {
            background: var(--chinese-red);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 12px;
            margin-right: 10px;
            flex-shrink: 0;
        }

        .workflow-arrow {
            text-align: center;
            color: var(--chinese-gold);
            font-size: 18px;
            margin: 4px 0;
        }

        .badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 600;
            margin: 0 4px;
        }

        .badge.new {
            background: var(--chinese-gold);
            color: #333;
        }

        .badge.beta {
            background: #4A90E2;
            color: white;
        }

        .badge.important {
            background: var(--chinese-red);
            color: white;
        }

        .expand-all {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--chinese-red), #CD5C5C);
            color: white;
            border: 2px solid var(--chinese-gold);
            padding: 10px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(139, 0, 0, 0.3);
            transition: all 0.2s ease;
            z-index: 1000;
        }

        .expand-all:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(139, 0, 0, 0.4);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé® Nabokov Web Clipper - Complete User Guide</h1>

        <div class="intro">
            <p><strong>Nabokov Web Clipper</strong> is a Chrome extension for capturing web content and organizing it on a visual canvas with AI-powered features.</p>
            <p>Clip elements from any webpage, create notes, connect ideas, and use Claude AI to generate insights.</p>
            <div class="citation">
                Research citation: Zhu, F. W., Agrawala, M., & Mysore, G. J. (2024). Nabokov: Organize Web Content with LLM-Powered Visual Canvas. UIST '24 Companion, Article 42, 1-3.
            </div>
        </div>

        <h2>‚ö° Quick Start</h2>
        <div class="workflow">
            <div class="workflow-step">
                <div class="workflow-number">1</div>
                <div>Install the Chrome extension and pin it to your toolbar</div>
            </div>
            <div class="workflow-arrow">‚Üì</div>
            <div class="workflow-step">
                <div class="workflow-number">2</div>
                <div>On any webpage, press <kbd>Cmd+Shift+E</kbd> (Mac) or <kbd>Ctrl+Shift+E</kbd> (Windows) to activate element selector</div>
            </div>
            <div class="workflow-arrow">‚Üì</div>
            <div class="workflow-step">
                <div class="workflow-number">3</div>
                <div>Click any element to capture it as a card</div>
            </div>
            <div class="workflow-arrow">‚Üì</div>
            <div class="workflow-step">
                <div class="workflow-number">4</div>
                <div>Click the extension icon to open your canvas and organize captured cards</div>
            </div>
        </div>

        <h2>üéØ Core Features</h2>

        <div class="collapsible critical">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> 1. Web Content Capture <span class="badge important">CORE</span></span>
            </div>
            <div class="collapsible-content">
                <h3>Element Selection Mode</h3>
                <p><strong>Keyboard shortcut:</strong> <kbd>Cmd+Shift+E</kbd> (Mac) / <kbd>Ctrl+Shift+E</kbd> (Windows)</p>
                <p><strong>Alternative:</strong> Right-click ‚Üí "Clip Element to Nabokov Canvas"</p>

                <div class="tip">
                    <strong>How it works:</strong> A visual overlay appears with Chinese-inspired red/gold styling. Hover over elements to see dimensions and tag info. Click to capture.
                </div>

                <h4>What Gets Captured:</h4>
                <ul>
                    <li><strong>HTML content:</strong> Sanitized element HTML with styles preserved</li>
                    <li><strong>Screenshot:</strong> Visual snapshot (optional, fails gracefully on CORS issues)</li>
                    <li><strong>Metadata:</strong> Page URL, title, domain, favicon, timestamp</li>
                    <li><strong>Context:</strong> Parent element HTML for reference</li>
                </ul>

                <h4>Controls:</h4>
                <ul>
                    <li><kbd>ESC</kbd> - Exit selection mode</li>
                    <li><kbd>Click</kbd> - Capture highlighted element</li>
                </ul>

                <div class="two-column">
                    <div class="card">
                        <h4>‚úÖ Best For</h4>
                        <ul>
                            <li>Article paragraphs</li>
                            <li>Code snippets</li>
                            <li>Product descriptions</li>
                            <li>Image galleries</li>
                            <li>Tables and data</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>‚ö†Ô∏è Limitations</h4>
                        <ul>
                            <li>Screenshots may fail on cross-origin images</li>
                            <li>Dynamic content may not preserve interactivity</li>
                            <li>Video/audio elements captured as placeholders</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="collapsible critical">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> 2. Visual Canvas Organization <span class="badge important">CORE</span></span>
            </div>
            <div class="collapsible-content">
                <h3>Opening the Canvas</h3>
                <ul>
                    <li>Click the extension icon in Chrome toolbar</li>
                    <li>Cards appear automatically after capture</li>
                    <li>Canvas page URL: <code>chrome-extension://[id]/src/canvas/index.html</code></li>
                </ul>

                <h3>Canvas Features</h3>
                <div class="feature-grid">
                    <div class="card">
                        <h4>üé® Infinite Canvas</h4>
                        <p>Pan, zoom, and arrange cards freely. Built with React Flow for smooth interactions.</p>
                    </div>
                    <div class="card">
                        <h4>üìç Auto-Save Positions</h4>
                        <p>Card positions and sizes saved automatically (2-second debounce).</p>
                    </div>
                    <div class="card">
                        <h4>üîç Filter & Search</h4>
                        <p>Filter by domain, tags, starred status. Search card content.</p>
                    </div>
                    <div class="card">
                        <h4>‚≠ê Star Cards</h4>
                        <p>Mark important cards with star icon. Filter to show only starred.</p>
                    </div>
                    <div class="card">
                        <h4>üè∑Ô∏è Tags</h4>
                        <p>Add tags to organize cards by topic. Filter by tag in toolbar.</p>
                    </div>
                    <div class="card">
                        <h4>üéØ Multi-Select</h4>
                        <p>Drag to select multiple cards. Move them together or delete in bulk.</p>
                    </div>
                </div>

                <h3>Card Display</h3>
                <ul>
                    <li><strong>Preview:</strong> Rendered HTML content with preserved styles</li>
                    <li><strong>Screenshot:</strong> Visual thumbnail (if captured successfully)</li>
                    <li><strong>Metadata:</strong> Source domain, URL, timestamp</li>
                    <li><strong>Tags:</strong> Color-coded tag badges</li>
                    <li><strong>Type indicator:</strong> Clipped, Note, Generated, Image</li>
                </ul>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> 3. Card Types <span class="badge new">4 TYPES</span></span>
            </div>
            <div class="collapsible-content">
                <div class="two-column">
                    <div class="card highlight">
                        <h4>üì∞ Clipped Cards</h4>
                        <p><strong>Source:</strong> Web content capture</p>
                        <p><strong>Contains:</strong> HTML, screenshot, metadata</p>
                        <p><strong>Created by:</strong> <kbd>Cmd+Shift+E</kbd></p>
                    </div>

                    <div class="card highlight">
                        <h4>üìù Note Cards</h4>
                        <p><strong>Source:</strong> Manual creation</p>
                        <p><strong>Contains:</strong> Plain text/HTML content</p>
                        <p><strong>Created by:</strong> <kbd>Cmd+N</kbd> on canvas</p>
                    </div>

                    <div class="card highlight">
                        <h4>ü§ñ Generated Cards</h4>
                        <p><strong>Source:</strong> AI generation from existing cards</p>
                        <p><strong>Contains:</strong> LLM response, parent link</p>
                        <p><strong>Created by:</strong> Custom button actions</p>
                    </div>

                    <div class="card highlight">
                        <h4>üñºÔ∏è Image Cards</h4>
                        <p><strong>Source:</strong> Drag & drop image files</p>
                        <p><strong>Contains:</strong> Base64 image data, dimensions</p>
                        <p><strong>Created by:</strong> Dragging images onto canvas</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="collapsible critical">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> 4. AI-Powered Card Generation <span class="badge new">LLM</span></span>
            </div>
            <div class="collapsible-content">
                <h3>Overview</h3>
                <p>Generate new cards from existing cards using Claude AI. Each card has customizable action buttons with prompt templates.</p>

                <h3>Default Buttons</h3>
                <div class="feature-grid">
                    <div class="card">
                        <h4>üìö Learn More</h4>
                        <p>Expand on the topic with additional context and examples.</p>
                    </div>
                    <div class="card">
                        <h4>üìã Summarize</h4>
                        <p>Create a concise summary of the card content.</p>
                    </div>
                    <div class="card">
                        <h4>üí≠ Critique</h4>
                        <p>Provide critical analysis and alternative perspectives.</p>
                    </div>
                    <div class="card">
                        <h4>üë∂ ELI5</h4>
                        <p>Explain like I'm 5 - simplify complex concepts.</p>
                    </div>
                    <div class="card">
                        <h4>üìñ Expand</h4>
                        <p>Add more detail and context to the content.</p>
                    </div>
                </div>

                <h3>How It Works</h3>
                <div class="workflow">
                    <div class="workflow-step">
                        <div class="workflow-number">1</div>
                        <div>Click a button on any card (e.g., "Summarize")</div>
                    </div>
                    <div class="workflow-arrow">‚Üì</div>
                    <div class="workflow-step">
                        <div class="workflow-number">2</div>
                        <div>Context input modal appears (optional additional context)</div>
                    </div>
                    <div class="workflow-arrow">‚Üì</div>
                    <div class="workflow-step">
                        <div class="workflow-number">3</div>
                        <div>Claude API processes card content + screenshot + context</div>
                    </div>
                    <div class="workflow-arrow">‚Üì</div>
                    <div class="workflow-step">
                        <div class="workflow-number">4</div>
                        <div>New card created with AI response</div>
                    </div>
                    <div class="workflow-arrow">‚Üì</div>
                    <div class="workflow-step">
                        <div class="workflow-number">5</div>
                        <div>Arrow connection automatically created between parent and generated card</div>
                    </div>
                </div>

                <div class="tip">
                    <strong>Pro Tip:</strong> Claude uses both the text content AND screenshot of the card for context, enabling visual analysis (e.g., analyzing charts, diagrams, UI elements).
                </div>

                <h3>Custom Buttons</h3>
                <p>Configure your own buttons with custom prompts. Template variables:</p>
                <ul>
                    <li><code>{{`{{content}}`}}</code> - Card's HTML content</li>
                    <li><code>{{`{{title}}`}}</code> - Page title</li>
                    <li><code>{{`{{customContext}}`}}</code> - User-provided additional context</li>
                </ul>

                <h4>Example Custom Button:</h4>
                <div class="card">
                    <p><strong>Button Label:</strong> "Translate to Spanish"</p>
                    <p><strong>Prompt Template:</strong> "Translate the following content to Spanish: {{`{{content}}`}}"</p>
                    <p><strong>Connection Type:</strong> "related"</p>
                </div>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> 5. Card Connections (Arrows) <span class="badge new">NEW</span></span>
            </div>
            <div class="collapsible-content">
                <h3>Creating Connections</h3>
                <ul>
                    <li><strong>Automatic:</strong> Generated cards auto-link to parent cards</li>
                    <li><strong>Manual:</strong> Drag from card edge handle to another card</li>
                </ul>

                <h3>Connection Types</h3>
                <table class="shortcut-table">
                    <tr>
                        <th>Type</th>
                        <th>Description</th>
                        <th>Visual Style</th>
                    </tr>
                    <tr>
                        <td><strong>related</strong></td>
                        <td>General relationship between cards</td>
                        <td>Gray dashed line</td>
                    </tr>
                    <tr>
                        <td><strong>generated-from</strong></td>
                        <td>AI-generated card from parent</td>
                        <td>Blue solid arrow</td>
                    </tr>
                    <tr>
                        <td><strong>references</strong></td>
                        <td>One card references another</td>
                        <td>Green dotted line</td>
                    </tr>
                    <tr>
                        <td><strong>contradicts</strong></td>
                        <td>Conflicting information</td>
                        <td>Red solid line</td>
                    </tr>
                    <tr>
                        <td><strong>custom</strong></td>
                        <td>User-defined relationship</td>
                        <td>Gold line with label</td>
                    </tr>
                </table>

                <h3>Editing Connections</h3>
                <ul>
                    <li><strong>Click on arrow</strong> - Opens Edge Edit Modal</li>
                    <li><strong>Change type</strong> - Select from dropdown</li>
                    <li><strong>Add label</strong> - Custom text for "custom" type</li>
                    <li><strong>Delete</strong> - Remove connection</li>
                </ul>

                <div class="tip">
                    <strong>Use Case:</strong> Build knowledge graphs by connecting related concepts, trace information sources, or visualize argument flows.
                </div>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> 6. Chat with Cards <span class="badge new">LLM</span></span>
            </div>
            <div class="collapsible-content">
                <h3>Opening Chat</h3>
                <p>Click the "Chat" button on any card to open a conversation window.</p>

                <h3>Features</h3>
                <ul>
                    <li><strong>Context-aware:</strong> Claude has access to card content and screenshot</li>
                    <li><strong>Persistent history:</strong> Conversations saved to card metadata</li>
                    <li><strong>Streaming responses:</strong> Watch AI responses appear in real-time</li>
                    <li><strong>Multi-turn:</strong> Continue conversations across sessions</li>
                </ul>

                <h3>Chat Controls</h3>
                <table class="shortcut-table">
                    <tr>
                        <th>Action</th>
                        <th>Keyboard Shortcut</th>
                    </tr>
                    <tr>
                        <td>Send message</td>
                        <td><kbd>Enter</kbd></td>
                    </tr>
                    <tr>
                        <td>New line in message</td>
                        <td><kbd>Shift+Enter</kbd></td>
                    </tr>
                    <tr>
                        <td>Close chat</td>
                        <td><kbd>ESC</kbd></td>
                    </tr>
                </table>

                <div class="tip">
                    <strong>Example Questions:</strong> "What are the key points?", "How does this relate to X?", "Can you explain this diagram?", "What are alternative viewpoints?"
                </div>

                <h3>FloatingWindow</h3>
                <p>Chat appears in a draggable, resizable floating window. Move it around the canvas to compare with other cards.</p>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> 7. Content Beautification <span class="badge beta">AI</span></span>
            </div>
            <div class="collapsible-content">
                <h3>Two Modes</h3>

                <div class="two-column">
                    <div class="card highlight">
                        <h4>üé® Recreate Design</h4>
                        <p><strong>Purpose:</strong> Recreate visual design from screenshot</p>
                        <p><strong>Best for:</strong> Cards with complex layouts, styling</p>
                        <p><strong>Output:</strong> Clean HTML that matches original appearance</p>
                    </div>

                    <div class="card highlight">
                        <h4>üìê Organize Content</h4>
                        <p><strong>Purpose:</strong> Restructure for readability</p>
                        <p><strong>Best for:</strong> Text-heavy content, articles</p>
                        <p><strong>Output:</strong> Better hierarchy, formatting, structure</p>
                    </div>
                </div>

                <h3>How to Use</h3>
                <ol>
                    <li>Open card menu (three dots)</li>
                    <li>Select "Beautify" option</li>
                    <li>Choose mode: "Recreate Design" or "Organize Content"</li>
                    <li>Wait for AI processing (uses Claude Vision)</li>
                    <li>Card content updates with beautified version</li>
                </ol>

                <div class="tip">
                    <strong>Note:</strong> Beautification uses Claude's vision capabilities to analyze screenshots. Requires API key configuration.
                </div>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> 8. Inline Editing</span>
            </div>
            <div class="collapsible-content">
                <h3>Edit Card Content Directly</h3>
                <p><strong>Trigger:</strong> Double-click on card content area</p>

                <h3>Editing Controls</h3>
                <table class="shortcut-table">
                    <tr>
                        <th>Action</th>
                        <th>Keyboard Shortcut</th>
                    </tr>
                    <tr>
                        <td>Save changes</td>
                        <td><kbd>Cmd/Ctrl+Enter</kbd> or click outside</td>
                    </tr>
                    <tr>
                        <td>Cancel editing</td>
                        <td><kbd>ESC</kbd></td>
                    </tr>
                </table>

                <div class="tip">
                    <strong>Safety:</strong> All edited content is sanitized with DOMPurify before saving to prevent XSS attacks.
                </div>

                <h3>What You Can Edit</h3>
                <ul>
                    <li>Card text content</li>
                    <li>HTML structure (uses <code>contentEditable</code>)</li>
                    <li>Note cards - full editing freedom</li>
                    <li>Generated cards - modify AI responses</li>
                </ul>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> 9. Image Upload <span class="badge new">NEW</span></span>
            </div>
            <div class="collapsible-content">
                <h3>Drag & Drop Images</h3>
                <p>Drag image files directly onto the canvas to create image cards.</p>

                <h3>Features</h3>
                <ul>
                    <li><strong>Supported formats:</strong> All image/* MIME types (PNG, JPG, GIF, SVG, etc.)</li>
                    <li><strong>Storage:</strong> Images converted to base64 data URLs</li>
                    <li><strong>Dimensions:</strong> Original width/height preserved</li>
                    <li><strong>Optional text:</strong> Add captions or notes to image cards</li>
                </ul>

                <h3>Workflow</h3>
                <div class="workflow">
                    <div class="workflow-step">
                        <div class="workflow-number">1</div>
                        <div>Drag image file from your computer</div>
                    </div>
                    <div class="workflow-arrow">‚Üì</div>
                    <div class="workflow-step">
                        <div class="workflow-number">2</div>
                        <div>Drop onto canvas area</div>
                    </div>
                    <div class="workflow-arrow">‚Üì</div>
                    <div class="workflow-step">
                        <div class="workflow-number">3</div>
                        <div>Image card created at drop position</div>
                    </div>
                </div>

                <div class="tip">
                    <strong>Use Case:</strong> Add reference images, screenshots from other apps, diagrams, inspiration boards, design mockups.
                </div>
            </div>
        </div>

        <div class="collapsible critical">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> 10. Keyboard Shortcuts <span class="badge important">ESSENTIAL</span></span>
            </div>
            <div class="collapsible-content">
                <h3>Global Shortcuts</h3>
                <table class="shortcut-table">
                    <tr>
                        <th>Action</th>
                        <th>Mac</th>
                        <th>Windows/Linux</th>
                    </tr>
                    <tr>
                        <td>Activate element selector</td>
                        <td><kbd>Cmd+Shift+E</kbd></td>
                        <td><kbd>Ctrl+Shift+E</kbd></td>
                    </tr>
                </table>

                <h3>Canvas Shortcuts</h3>
                <table class="shortcut-table">
                    <tr>
                        <th>Action</th>
                        <th>Mac</th>
                        <th>Windows/Linux</th>
                    </tr>
                    <tr>
                        <td>Create new note card</td>
                        <td><kbd>Cmd+N</kbd></td>
                        <td><kbd>Ctrl+N</kbd></td>
                    </tr>
                    <tr>
                        <td>Delete selected card(s)</td>
                        <td><kbd>Delete</kbd> or <kbd>Backspace</kbd></td>
                        <td><kbd>Delete</kbd> or <kbd>Backspace</kbd></td>
                    </tr>
                    <tr>
                        <td>Navigate between cards</td>
                        <td><kbd>Arrow Keys</kbd></td>
                        <td><kbd>Arrow Keys</kbd></td>
                    </tr>
                    <tr>
                        <td>Save inline edit</td>
                        <td><kbd>Cmd+Enter</kbd></td>
                        <td><kbd>Ctrl+Enter</kbd></td>
                    </tr>
                    <tr>
                        <td>Cancel/Close</td>
                        <td><kbd>ESC</kbd></td>
                        <td><kbd>ESC</kbd></td>
                    </tr>
                </table>

                <h3>Chat Shortcuts</h3>
                <table class="shortcut-table">
                    <tr>
                        <th>Action</th>
                        <th>Shortcut</th>
                    </tr>
                    <tr>
                        <td>Send message</td>
                        <td><kbd>Enter</kbd></td>
                    </tr>
                    <tr>
                        <td>New line in message</td>
                        <td><kbd>Shift+Enter</kbd></td>
                    </tr>
                    <tr>
                        <td>Close chat</td>
                        <td><kbd>ESC</kbd></td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> 11. API Configuration <span class="badge important">REQUIRED</span></span>
            </div>
            <div class="collapsible-content">
                <h3>Setting Up Claude API</h3>
                <p>AI features require a Claude API key from Anthropic.</p>

                <div class="workflow">
                    <div class="workflow-step">
                        <div class="workflow-number">1</div>
                        <div>Get API key from <code>console.anthropic.com</code></div>
                    </div>
                    <div class="workflow-arrow">‚Üì</div>
                    <div class="workflow-step">
                        <div class="workflow-number">2</div>
                        <div>Open Canvas ‚Üí Click "API Settings" button</div>
                    </div>
                    <div class="workflow-arrow">‚Üì</div>
                    <div class="workflow-step">
                        <div class="workflow-number">3</div>
                        <div>Paste API key into input field</div>
                    </div>
                    <div class="workflow-arrow">‚Üì</div>
                    <div class="workflow-step">
                        <div class="workflow-number">4</div>
                        <div>Click "Save" - key stored securely in chrome.storage.local</div>
                    </div>
                </div>

                <h3>Features Requiring API Key</h3>
                <ul>
                    <li>Card generation (custom buttons)</li>
                    <li>Chat with cards</li>
                    <li>Content beautification</li>
                    <li>Screenshot analysis (vision mode)</li>
                </ul>

                <h3>Default Model</h3>
                <p><code>claude-sonnet-4-20250514</code></p>

                <div class="tip">
                    <strong>Privacy:</strong> API key stored locally in browser. Never transmitted except to Anthropic's API. Falls back to mock responses in development mode.
                </div>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> 12. Storage & Data</span>
            </div>
            <div class="collapsible-content">
                <h3>Storage Architecture</h3>

                <div class="two-column">
                    <div class="card">
                        <h4>chrome.storage.local</h4>
                        <p><strong>Stores:</strong> Card metadata</p>
                        <p><strong>Limit:</strong> ~5MB (JSON serialized)</p>
                        <p><strong>Keys:</strong></p>
                        <ul>
                            <li><code>'cards'</code> - Card array</li>
                            <li><code>'nabokov_canvas_state'</code> - Positions, zoom</li>
                            <li><code>'nabokov_filters'</code> - Filter state</li>
                            <li><code>'nabokov_connections'</code> - Arrows</li>
                            <li><code>'nabokov_claude_api_key'</code> - API key</li>
                        </ul>
                    </div>

                    <div class="card">
                        <h4>IndexedDB</h4>
                        <p><strong>Stores:</strong> Screenshots (compressed)</p>
                        <p><strong>Limit:</strong> Much larger (browser-dependent)</p>
                        <p><strong>Database:</strong> <code>'nabokov-clipper'</code></p>
                        <p><strong>Store:</strong> <code>'screenshots'</code></p>
                        <p><strong>Key:</strong> <code>screenshotId</code> (matches Card)</p>
                    </div>
                </div>

                <h3>Data Persistence</h3>
                <ul>
                    <li>All data stored locally in browser</li>
                    <li>No server sync (privacy-focused)</li>
                    <li>Survives browser restarts</li>
                    <li>Lost if extension uninstalled (backup not yet implemented)</li>
                </ul>

                <div class="tip">
                    <strong>Pro Tip:</strong> Screenshot compression reduces storage usage by ~50-70% while maintaining visual quality.
                </div>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> 13. Tips & Best Practices</span>
            </div>
            <div class="collapsible-content">
                <div class="feature-grid">
                    <div class="card">
                        <h4>üìå Organize with Tags</h4>
                        <p>Add tags like "research", "todo", "important" to cards for easy filtering.</p>
                    </div>

                    <div class="card">
                        <h4>‚≠ê Star Important Cards</h4>
                        <p>Use starring to mark key cards. Quick filter to see only starred cards.</p>
                    </div>

                    <div class="card">
                        <h4>üîó Build Knowledge Graphs</h4>
                        <p>Connect related cards with arrows to visualize relationships and argument flows.</p>
                    </div>

                    <div class="card">
                        <h4>ü§ñ Chain AI Actions</h4>
                        <p>Generate card ‚Üí Chat about it ‚Üí Generate more cards. Build on AI responses.</p>
                    </div>

                    <div class="card">
                        <h4>üìù Mix Card Types</h4>
                        <p>Combine clipped content, notes, generated insights, and images on one canvas.</p>
                    </div>

                    <div class="card">
                        <h4>üé® Use Beautification</h4>
                        <p>Messy captures? Use "Recreate Design" or "Organize Content" to clean them up.</p>
                    </div>

                    <div class="card">
                        <h4>üí¨ Context in Chat</h4>
                        <p>Ask Claude to relate card content to your specific use case or project.</p>
                    </div>

                    <div class="card">
                        <h4>üñºÔ∏è Visual References</h4>
                        <p>Drag design mockups, wireframes, or inspiration images onto canvas.</p>
                    </div>
                </div>

                <h3>Workflow Examples</h3>

                <h4>Research Project</h4>
                <ol>
                    <li>Clip key paragraphs from papers/articles</li>
                    <li>Use "Summarize" to create condensed versions</li>
                    <li>Connect related concepts with arrows</li>
                    <li>Add note cards with your own thoughts</li>
                    <li>Chat with cards to explore connections</li>
                </ol>

                <h4>Content Creation</h4>
                <ol>
                    <li>Clip examples from web</li>
                    <li>Use "Critique" to analyze approaches</li>
                    <li>Generate "Learn More" cards for deep dives</li>
                    <li>Create note cards with your outline</li>
                    <li>Connect cards to show information flow</li>
                </ol>

                <h4>Learning New Topic</h4>
                <ol>
                    <li>Clip tutorials, docs, examples</li>
                    <li>Use "ELI5" on complex concepts</li>
                    <li>Chat to ask clarifying questions</li>
                    <li>Create note cards with key takeaways</li>
                    <li>Tag by difficulty/topic</li>
                </ol>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> 14. Troubleshooting</span>
            </div>
            <div class="collapsible-content">
                <h3>Common Issues</h3>

                <h4>‚ùå "Screenshot capture failed"</h4>
                <p><strong>Cause:</strong> Cross-origin (CORS) restrictions</p>
                <p><strong>Solution:</strong> Expected behavior. Card still created with HTML content. Not critical.</p>

                <h4>‚ùå "Claude API key not configured"</h4>
                <p><strong>Cause:</strong> No API key set</p>
                <p><strong>Solution:</strong> Open API Settings and enter your Anthropic API key.</p>

                <h4>‚ùå Element selector not responding</h4>
                <p><strong>Cause:</strong> Content script injection timing</p>
                <p><strong>Solution:</strong> Refresh the page and try again. Check extension is enabled.</p>

                <h4>‚ùå Cards not appearing after capture</h4>
                <p><strong>Cause:</strong> Storage timing issue</p>
                <p><strong>Solution:</strong> Refresh canvas page. Cards should appear.</p>

                <h4>‚ùå Extension not updating after rebuild</h4>
                <p><strong>Cause:</strong> Chrome caches extension code</p>
                <p><strong>Solution:</strong> Go to <code>chrome://extensions</code> and click reload icon on extension card.</p>

                <h4>‚ùå Card content looks broken</h4>
                <p><strong>Cause:</strong> CSS conflicts or missing styles</p>
                <p><strong>Solution:</strong> Use "Beautify" ‚Üí "Recreate Design" to fix layout.</p>

                <h3>Performance Tips</h3>
                <ul>
                    <li><strong>Many cards?</strong> Use filters to show subsets. Canvas handles 100+ cards.</li>
                    <li><strong>Large screenshots?</strong> Compression is automatic. Old cards may be larger.</li>
                    <li><strong>Slow AI responses?</strong> Claude API latency varies. Streaming shows progress.</li>
                </ul>
            </div>
        </div>

        <h2>üéì Advanced Features</h2>

        <div class="collapsible">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> Custom Button Configuration</span>
            </div>
            <div class="collapsible-content">
                <p>Coming soon: UI for creating custom action buttons with your own prompt templates.</p>
                <p><strong>Current:</strong> Default buttons (Learn More, Summarize, Critique, ELI5, Expand)</p>
                <p><strong>Future:</strong> Full customization of button labels, prompts, connection types</p>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> Export & Backup</span>
            </div>
            <div class="collapsible-content">
                <p><strong>Status:</strong> Not yet implemented</p>
                <p><strong>Planned:</strong></p>
                <ul>
                    <li>Export canvas as JSON</li>
                    <li>Export as HTML page</li>
                    <li>Backup/restore from file</li>
                    <li>Sync across devices (maybe)</li>
                </ul>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span> Collaboration</span>
            </div>
            <div class="collapsible-content">
                <p><strong>Status:</strong> Single-user only (local storage)</p>
                <p><strong>Future Ideas:</strong></p>
                <ul>
                    <li>Share canvas with others</li>
                    <li>Real-time collaboration</li>
                    <li>Comment on cards</li>
                    <li>Version history</li>
                </ul>
            </div>
        </div>

        <h2>üìö Additional Resources</h2>
        <ul>
            <li><strong>Research Paper:</strong> Zhu, F. W., Agrawala, M., & Mysore, G. J. (2024). <em>Nabokov: Organize Web Content with LLM-Powered Visual Canvas</em>. UIST '24 Companion, Article 42, 1-3.</li>
            <li><strong>GitHub:</strong> (Check your extension manifest for repository URL)</li>
            <li><strong>Anthropic Claude API:</strong> <code>console.anthropic.com</code></li>
        </ul>

        <button class="expand-all" onclick="toggleAll()">Expand All Sections</button>
    </div>

    <script>
        // Collapsible functionality
        document.querySelectorAll('.collapsible-header').forEach(header => {
            header.addEventListener('click', () => {
                const collapsible = header.parentElement;
                collapsible.classList.toggle('open');
            });
        });

        // Expand/collapse all
        let allExpanded = false;
        function toggleAll() {
            const button = document.querySelector('.expand-all');
            const collapsibles = document.querySelectorAll('.collapsible');

            if (!allExpanded) {
                collapsibles.forEach(c => c.classList.add('open'));
                button.textContent = 'Collapse All Sections';
                allExpanded = true;
            } else {
                collapsibles.forEach(c => c.classList.remove('open'));
                button.textContent = 'Expand All Sections';
                allExpanded = false;
            }
        }

        // Open critical sections by default
        document.querySelectorAll('.collapsible.critical').forEach(c => {
            c.classList.add('open');
        });
    </script>
</body>
</html>