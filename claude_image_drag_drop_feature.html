<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Drag-and-Drop Feature Analysis</title>
    <style>
        :root {
            --chinese-red: #8B0000;
            --chinese-gold: #FFD700;
            --paper-beige: #F5F5DC;
            --light-cream: #FFFAF0;
            --ink-black: #2C2C2C;
            --level-1: #8B0000;
            --level-2: #CD5C5C;
            --level-3: #B8860B;
            --level-4: #666;
        }

        body {
            background: linear-gradient(135deg, var(--paper-beige) 0%, var(--light-cream) 100%);
            color: var(--ink-black);
            margin: 0;
            padding: 0;
            width: 100vw;
            max-width: 100%;
            line-height: 1.2;
            font-size: 14px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'SF Pro', Roboto, Arial, sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        .container {
            width: 100%;
            padding: 12px;
            margin: 0;
        }

        h1 {
            font-size: 24px;
            font-weight: 900;
            margin: 4px 0;
            padding: 6px 4px;
            background: linear-gradient(135deg, var(--chinese-red), #CD5C5C);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
        }

        h2 {
            font-size: 18px;
            font-weight: 700;
            margin: 8px 0 4px 0;
            padding: 4px;
            border-left: 4px solid var(--chinese-red);
            background: rgba(139, 0, 0, 0.03);
            color: var(--level-1);
        }

        h3 {
            font-size: 14px;
            font-weight: 600;
            margin: 4px 0 2px 8px;
            color: var(--level-2);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        h4 {
            font-size: 12px;
            font-weight: 500;
            margin: 2px 0 1px 16px;
            color: var(--level-3);
        }

        .important-always-visible {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), white);
            border: 2px solid var(--chinese-gold);
            padding: 8px;
            margin: 8px 0;
            border-radius: 3px;
        }

        .important-always-visible h2 {
            color: var(--chinese-red);
            margin-top: 0;
        }

        .primary-section {
            border: 2px solid var(--chinese-red);
            background: white;
            margin: 6px 0;
            padding: 6px;
        }

        .secondary-section {
            border-left: 3px solid var(--chinese-gold);
            background: rgba(255, 215, 0, 0.05);
            margin: 4px 0 4px 8px;
            padding: 4px;
        }

        .tertiary-section {
            margin-left: 16px;
            padding-left: 8px;
            border-left: 1px dashed #ccc;
        }

        .card {
            background: white;
            border: 1px solid rgba(139, 0, 0, 0.2);
            border-radius: 2px;
            padding: 6px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            margin: 4px 0;
        }

        .card.priority {
            border: 2px solid var(--chinese-gold);
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.05), white);
        }

        .dense-list {
            list-style: none;
            padding: 0;
            margin-left: 8px;
        }

        .dense-list li {
            padding: 2px 0 2px 12px;
            border-left: 2px solid transparent;
            position: relative;
        }

        .dense-list li:before {
            content: "‚ñ∏";
            position: absolute;
            left: 0;
            color: var(--chinese-red);
            font-size: 10px;
        }

        .dense-list li strong {
            color: var(--level-2);
            font-weight: 600;
        }

        pre, code {
            background: linear-gradient(135deg, rgba(245, 245, 220, 0.3), rgba(255, 255, 255, 0.5));
            border: 1px solid rgba(139, 0, 0, 0.1);
            padding: 2px 4px;
            margin: 1px 0;
            font-size: 12px;
            line-height: 1.3;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Courier New', monospace;
        }

        pre {
            padding: 6px 8px;
            margin: 4px 0;
            overflow-x: auto;
            border-radius: 2px;
        }

        .two-column-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin: 8px 0;
        }

        .full-width {
            grid-column: span 2;
        }

        .collapsible {
            margin: 4px 0;
            width: 100%;
        }

        .collapsible-header {
            cursor: pointer;
            padding: 6px 8px;
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.05), rgba(255, 215, 0, 0.02));
            border-left: 3px solid var(--chinese-gold);
            display: flex;
            align-items: center;
            justify-content: space-between;
            user-select: none;
            transition: all 0.2s ease;
        }

        .collapsible-header:hover {
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.1), rgba(255, 215, 0, 0.05));
        }

        .collapsible-header .arrow {
            display: inline-block;
            transition: transform 0.3s ease;
            color: var(--chinese-red);
            font-size: 10px;
            margin-right: 6px;
        }

        .collapsible.open .arrow {
            transform: rotate(90deg);
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            padding: 0 8px;
            margin-left: 12px;
        }

        .collapsible.open .collapsible-content {
            max-height: 5000px;
            padding: 8px;
        }

        .collapsible.critical .collapsible-header {
            border-left: 4px solid var(--chinese-red);
            background: rgba(139, 0, 0, 0.08);
            font-weight: 700;
        }

        .collapsible.secondary .collapsible-header {
            border-left: 2px solid #999;
            background: rgba(0, 0, 0, 0.02);
            font-size: 13px;
        }

        .indent-1 { margin-left: 12px; }
        .indent-2 { margin-left: 24px; }
        .indent-3 { margin-left: 36px; }

        .divider {
            height: 1px;
            background: linear-gradient(90deg, var(--chinese-red), transparent);
            margin: 8px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 4px 0;
            font-size: 12px;
        }

        th, td {
            border: 1px solid rgba(139, 0, 0, 0.2);
            padding: 4px 6px;
            text-align: left;
            line-height: 1.2;
        }

        th {
            background: rgba(139, 0, 0, 0.1);
            font-weight: 600;
        }

        .warning {
            background: rgba(255, 165, 0, 0.1);
            border-left: 3px solid orange;
            padding: 4px 8px;
            margin: 4px 0;
        }

        .error {
            background: rgba(255, 0, 0, 0.05);
            border-left: 3px solid red;
            padding: 4px 8px;
            margin: 4px 0;
        }

        .success {
            background: rgba(0, 128, 0, 0.05);
            border-left: 3px solid green;
            padding: 4px 8px;
            margin: 4px 0;
        }

        .info {
            background: rgba(0, 123, 255, 0.05);
            border-left: 3px solid #007bff;
            padding: 4px 8px;
            margin: 4px 0;
        }

        .example-box {
            background: rgba(138, 43, 226, 0.03);
            border: 1px solid rgba(138, 43, 226, 0.3);
            padding: 6px;
            margin: 6px 0;
            border-radius: 2px;
        }

        .vs {
            font-weight: 900;
            color: var(--chinese-red);
            font-size: 16px;
            text-align: center;
        }

        .badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 2px;
            font-size: 10px;
            font-weight: 700;
            margin: 0 3px;
            text-transform: uppercase;
        }

        .badge.new { background: rgba(138, 43, 226, 0.2); color: #4B0082; }
        .badge.easy { background: rgba(0, 200, 0, 0.2); color: #006400; }
        .badge.medium { background: rgba(255, 165, 0, 0.2); color: #FF8C00; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üñºÔ∏è Image Drag-and-Drop Feature Analysis</h1>

        <div class="important-always-visible">
            <h2>Quick Answer</h2>
            <ul class="dense-list">
                <li><strong>Currently Supported?</strong> ‚ùå NO - not in the implementation plan</li>
                <li><strong>Your Idea:</strong> ‚úÖ Excellent! Skip problematic auto-screenshots, let users drag images</li>
                <li><strong>Effort Estimate:</strong> 4-6 hours (easy to implement)</li>
                <li><strong>Recommended Phase:</strong> Phase 1 (foundation feature)</li>
            </ul>
        </div>

        <div class="divider"></div>

        <h2>1. Current State Analysis</h2>

        <div class="primary-section">
            <h3>What's in the Implementation Plan</h3>
            <div class="two-column-layout">
                <div class="card">
                    <strong>Phase 1 (20-28h)</strong>
                    <ul class="dense-list">
                        <li>Inline Context Input</li>
                        <li>Enhanced Chat</li>
                        <li>Collapsible Cards</li>
                        <li>Resizable Cards</li>
                    </ul>
                </div>
                <div class="card">
                    <strong>Phase 2 (28-38h)</strong>
                    <ul class="dense-list">
                        <li>Chrome Side Panel Stash</li>
                        <li>Custom Button System</li>
                        <li>Markdown Support</li>
                    </ul>
                </div>
            </div>
            <p style="margin-top: 6px;"><strong>Phase 3 & 4:</strong> Structured cards, templates, testing, docs</p>
        </div>

        <div class="error">
            <h3>‚ùå What's NOT in the Plan</h3>
            <ul class="dense-list">
                <li><strong>Drag-and-drop image upload</strong> - Not mentioned anywhere</li>
                <li><strong>Manual image card creation</strong> - Not supported</li>
                <li><strong>File picker for images</strong> - Not implemented</li>
            </ul>
            <p style="margin-top: 6px;"><strong>Current Image Support:</strong> Only automatic screenshots via <code>captureVisibleTab()</code> (which has CORS issues)</p>
        </div>

        <div class="divider"></div>

        <h2>2. Why Skip Automatic Screenshots?</h2>

        <div class="two-column-layout">
            <div class="card">
                <h3>Problems with Auto-Screenshots</h3>
                <ul class="dense-list">
                    <li><strong>CORS Issues:</strong> Fails when page has cross-origin images</li>
                    <li><strong>Canvas Tainting:</strong> Cannot export cropped images</li>
                    <li><strong>Unreliable:</strong> Silent failures, no visual feedback</li>
                    <li><strong>Complex Code:</strong> Try-catch wrappers, compression, cropping</li>
                    <li><strong>Storage Overhead:</strong> Full viewport screenshots are large</li>
                </ul>
            </div>

            <div class="card priority">
                <h3>Benefits of Manual Drag-Drop</h3>
                <ul class="dense-list">
                    <li><strong>No CORS Issues:</strong> User controls the image source</li>
                    <li><strong>Reliable:</strong> Always works, no browser restrictions</li>
                    <li><strong>User Control:</strong> Choose exactly what image to add</li>
                    <li><strong>Flexible:</strong> Any image source (local files, screenshots, web)</li>
                    <li><strong>Simpler Code:</strong> No captureVisibleTab, no cropping logic</li>
                </ul>
            </div>
        </div>

        <div class="success" style="margin-top: 8px;">
            <strong>‚úÖ Your Idea is BETTER:</strong> Skip automatic screenshots entirely. Let users take their own screenshots (Cmd+Shift+4 on Mac, Snipping Tool on Windows) and drag them into the canvas.
        </div>

        <div class="divider"></div>

        <h2>3. Implementation Plan</h2>

        <div class="primary-section">
            <h3>Feature Specification</h3>
            <ul class="dense-list">
                <li><strong>Drag-and-drop zone:</strong> Entire canvas area accepts image drops</li>
                <li><strong>Supported formats:</strong> PNG, JPG, JPEG, GIF, WebP</li>
                <li><strong>Storage:</strong> IndexedDB (same as current screenshot system)</li>
                <li><strong>Card creation:</strong> Drop image ‚Üí Create card at drop position with image</li>
                <li><strong>Visual feedback:</strong> Drop zone indicator, loading state</li>
            </ul>
        </div>

        <div class="collapsible critical">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span><strong>Step-by-Step Implementation (4-6 hours)</strong></span>
            </div>
            <div class="collapsible-content">
                <table>
                    <thead>
                        <tr>
                            <th style="width: 5%;">Step</th>
                            <th style="width: 35%;">File</th>
                            <th style="width: 45%;">Task</th>
                            <th style="width: 15%;">Time</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td><code>src/types/card.ts</code></td>
                            <td>Add <code>imageOnly: boolean</code> field to Card interface</td>
                            <td>15min</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td><code>src/utils/imageUpload.ts</code></td>
                            <td>Create utility: validate file type, read as data URL, compress if needed</td>
                            <td>1-1.5h</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td><code>src/canvas/Canvas.tsx</code></td>
                            <td>Add drag-and-drop event handlers (dragover, drop)</td>
                            <td>1-1.5h</td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td><code>src/canvas/Canvas.tsx</code></td>
                            <td>Implement card creation: save image to IndexedDB, create Card, add to canvas</td>
                            <td>1h</td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td><code>src/canvas/CardNode.tsx</code></td>
                            <td>Add image-only card rendering mode (no HTML content, just image)</td>
                            <td>30min</td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td><code>src/canvas/Canvas.tsx</code></td>
                            <td>Add visual drop zone indicator (dashed border on dragover)</td>
                            <td>30min</td>
                        </tr>
                        <tr>
                            <td>7</td>
                            <td><code>tests/e2e/</code></td>
                            <td>E2E test: drag image ‚Üí verify card created ‚Üí reload ‚Üí verify persists</td>
                            <td>1h</td>
                        </tr>
                    </tbody>
                </table>

                <div class="info" style="margin-top: 8px;">
                    <strong>Total Effort:</strong> 4-6 hours (Phase 1 candidate)
                </div>
            </div>
        </div>

        <div class="divider"></div>

        <h2>4. Code Implementation</h2>

        <div class="collapsible critical">
            <div class="collapsible-header">
                <span><span class="arrow">‚ñ∂</span><strong>Core Code Examples</strong></span>
            </div>
            <div class="collapsible-content">
                <h4>1. Image Upload Utility</h4>
                <pre><code>// src/utils/imageUpload.ts
export async function processImageFile(file: File): Promise&lt;string&gt; {
  // Validate file type
  const validTypes = ['image/png', 'image/jpeg', 'image/jpg', 'image/gif', 'image/webp'];
  if (!validTypes.includes(file.type)) {
    throw new Error('Invalid file type. Only images allowed.');
  }

  // Size limit: 10MB
  if (file.size > 10 * 1024 * 1024) {
    throw new Error('Image too large. Max 10MB.');
  }

  // Read as data URL
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.onload = () => resolve(reader.result as string);
    reader.onerror = () => reject(new Error('Failed to read file'));
    reader.readAsDataURL(file);
  });
}

export async function compressImageIfNeeded(dataUrl: string, maxWidth = 1920): Promise&lt;string&gt; {
  return new Promise((resolve) => {
    const img = new Image();
    img.onload = () => {
      if (img.width <= maxWidth) {
        resolve(dataUrl); // No compression needed
        return;
      }

      // Compress
      const canvas = document.createElement('canvas');
      const ratio = maxWidth / img.width;
      canvas.width = maxWidth;
      canvas.height = img.height * ratio;

      const ctx = canvas.getContext('2d')!;
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

      resolve(canvas.toDataURL('image/jpeg', 0.85));
    };
    img.src = dataUrl;
  });
}</code></pre>

                <h4 style="margin-top: 8px;">2. Canvas Drag-and-Drop Handlers</h4>
                <pre><code>// src/canvas/Canvas.tsx
const [isDraggingOver, setIsDraggingOver] = useState(false);

const handleDragOver = (event: React.DragEvent) => {
  event.preventDefault();
  event.stopPropagation();
  setIsDraggingOver(true);
};

const handleDragLeave = (event: React.DragEvent) => {
  event.preventDefault();
  event.stopPropagation();
  setIsDraggingOver(false);
};

const handleDrop = async (event: React.DragEvent) => {
  event.preventDefault();
  event.stopPropagation();
  setIsDraggingOver(false);

  const files = Array.from(event.dataTransfer.files);
  const imageFiles = files.filter(f => f.type.startsWith('image/'));

  if (imageFiles.length === 0) {
    console.warn('No image files found');
    return;
  }

  // Get drop position in canvas coordinates
  const rect = event.currentTarget.getBoundingClientRect();
  const x = event.clientX - rect.left;
  const y = event.clientY - rect.top;

  // Process each image
  for (const file of imageFiles) {
    try {
      const dataUrl = await processImageFile(file);
      const compressed = await compressImageIfNeeded(dataUrl);

      // Save to IndexedDB
      const screenshotId = generateId();
      await saveScreenshot(screenshotId, compressed);

      // Create card
      const card: Card = {
        id: generateId(),
        content: '', // Empty content for image-only cards
        imageOnly: true,
        metadata: {
          url: '',
          title: file.name,
          domain: 'local',
          timestamp: Date.now(),
        },
        position: { x, y: y + cards.length * 20 }, // Offset multiple drops
        screenshotId,
        starred: false,
        tags: ['image'],
        createdAt: Date.now(),
        updatedAt: Date.now(),
      };

      await saveCard(card);
      // Trigger canvas refresh
    } catch (error) {
      console.error('Failed to process image:', error);
    }
  }
};</code></pre>

                <h4 style="margin-top: 8px;">3. Visual Drop Zone Indicator</h4>
                <pre><code>// In Canvas.tsx JSX
&lt;div
  className={`canvas-container ${isDraggingOver ? 'drag-over' : ''}`}
  onDragOver={handleDragOver}
  onDragLeave={handleDragLeave}
  onDrop={handleDrop}
&gt;
  {/* React Flow canvas */}
&lt;/div&gt;

// CSS
.canvas-container.drag-over {
  outline: 3px dashed var(--chinese-gold);
  outline-offset: -10px;
  background: rgba(255, 215, 0, 0.05);
}</code></pre>

                <h4 style="margin-top: 8px;">4. Image-Only Card Rendering</h4>
                <pre><code>// src/canvas/CardNode.tsx
const CardNode = ({ data }: { data: { card: Card } }) => {
  const { card } = data;
  const [imageUrl, setImageUrl] = useState&lt;string | null&gt;(null);

  useEffect(() => {
    if (card.screenshotId) {
      loadScreenshot(card.screenshotId).then(setImageUrl);
    }
  }, [card.screenshotId]);

  if (card.imageOnly) {
    return (
      &lt;div className="card-node image-only"&gt;
        &lt;div className="card-header"&gt;
          &lt;span&gt;{card.metadata.title}&lt;/span&gt;
          {/* Delete, star buttons */}
        &lt;/div&gt;
        {imageUrl && (
          &lt;img
            src={imageUrl}
            alt={card.metadata.title}
            className="card-image"
            style={{ maxWidth: '100%', height: 'auto' }}
          /&gt;
        )}
      &lt;/div&gt;
    );
  }

  // Regular card rendering...
};</code></pre>
            </div>
        </div>

        <div class="divider"></div>

        <h2>5. Updated Card Interface</h2>

        <div class="example-box">
            <h4>Add to src/types/card.ts</h4>
            <pre><code>export interface Card {
  id: string;
  content: string;
  <strong>imageOnly?: boolean;         // NEW: True for drag-dropped images</strong>
  metadata: ClipMetadata;
  position?: CardPosition;
  size?: CardSize;
  starred: boolean;
  tags: string[];
  createdAt: number;
  updatedAt: number;
  conversation?: Message[];
  screenshotId?: string;
  styles?: RelevantStyles;
  context?: string;
}</code></pre>
        </div>

        <div class="divider"></div>

        <h2>6. Where This Fits in the Plan</h2>

        <div class="primary-section">
            <h3>Recommended: Add to Phase 1 <span class="badge new">Foundation</span></h3>
            <p style="margin-bottom: 6px;"><strong>Reasoning:</strong></p>
            <ul class="dense-list">
                <li><strong>Core Functionality:</strong> Image cards are fundamental content type</li>
                <li><strong>Low Effort:</strong> 4-6 hours fits well in Phase 1 (20-28h total)</li>
                <li><strong>Independent:</strong> No dependencies on other features</li>
                <li><strong>High Value:</strong> Solves CORS issues, enables user workflows</li>
            </ul>

            <div class="success" style="margin-top: 8px;">
                <strong>Updated Phase 1 Timeline:</strong> 24-34 hours (was 20-28h)
                <br><strong>New Feature Count:</strong> 5 features (was 4)
            </div>
        </div>

        <div class="secondary-section">
            <h3>Alternative: Add to Phase 2</h3>
            <p class="indent-1">Could also fit in Phase 2 (browser integration) alongside Side Panel, but Phase 1 is more logical since it's a basic content creation method.</p>
        </div>

        <div class="divider"></div>

        <h2>7. Testing Strategy</h2>

        <div class="two-column-layout">
            <div class="card">
                <h3>Unit Tests (Vitest)</h3>
                <ul class="dense-list">
                    <li><strong>processImageFile:</strong> Validate file types, size limits</li>
                    <li><strong>compressImageIfNeeded:</strong> Verify compression logic</li>
                    <li><strong>Card creation:</strong> Test imageOnly card structure</li>
                </ul>
            </div>

            <div class="card">
                <h3>E2E Tests (Playwright)</h3>
                <ul class="dense-list">
                    <li><strong>Drag single image:</strong> Verify card appears at drop position</li>
                    <li><strong>Drag multiple images:</strong> Verify offset positioning</li>
                    <li><strong>Persistence:</strong> Reload ‚Üí verify image cards still present</li>
                    <li><strong>Invalid files:</strong> Drag non-image ‚Üí verify error handling</li>
                </ul>
            </div>
        </div>

        <div class="example-box">
            <h4>E2E Test Example</h4>
            <pre><code>// tests/e2e/image-upload.spec.ts
test('drag and drop image creates card', async ({ page }) => {
  await page.goto('chrome-extension://[id]/src/canvas/index.html');

  // Create data transfer with image file
  const buffer = await fs.promises.readFile('test-fixtures/test-image.png');
  const dataTransfer = await page.evaluateHandle((data) => {
    const dt = new DataTransfer();
    const file = new File([new Uint8Array(data)], 'test.png', { type: 'image/png' });
    dt.items.add(file);
    return dt;
  }, Array.from(buffer));

  // Trigger drop
  await page.dispatchEvent('.canvas-container', 'drop', { dataTransfer });

  // Verify card created
  await expect(page.locator('.card-node.image-only')).toBeVisible();
  await expect(page.locator('.card-image')).toHaveAttribute('alt', 'test.png');
});</code></pre>
        </div>

        <div class="divider"></div>

        <h2>8. Bonus: File Picker Support</h2>

        <div class="secondary-section">
            <h3>Additional Enhancement (Optional)</h3>
            <p class="indent-1">Beyond drag-and-drop, add a file picker button for users who prefer clicking:</p>

            <pre style="margin-top: 4px;"><code>// Add to Canvas toolbar
&lt;button onClick={handleFilePickerClick}&gt;
  üì∑ Add Image
&lt;/button&gt;

&lt;input
  type="file"
  ref={fileInputRef}
  accept="image/*"
  multiple
  onChange={handleFileSelect}
  style={{ display: 'none' }}
/&gt;</code></pre>

            <p class="indent-1"><strong>Effort:</strong> +30 minutes to 1 hour</p>
        </div>

        <div class="divider"></div>

        <div class="important-always-visible">
            <h2>‚úÖ Summary & Recommendation</h2>

            <h3 style="margin-top: 6px;">Your Proposal</h3>
            <p class="indent-1"><strong>Skip automatic screenshots, use drag-and-drop images instead</strong></p>

            <h3 style="margin-top: 6px;">Assessment</h3>
            <ul class="dense-list">
                <li><strong>‚úÖ Better UX:</strong> User controls what images to add, when</li>
                <li><strong>‚úÖ No CORS Issues:</strong> Completely avoids browser security restrictions</li>
                <li><strong>‚úÖ Simpler Code:</strong> No captureVisibleTab, cropping, or error handling</li>
                <li><strong>‚úÖ Easy to Implement:</strong> 4-6 hours total effort</li>
                <li><strong>‚úÖ Fits Phase 1:</strong> Foundation feature, no dependencies</li>
            </ul>

            <h3 style="margin-top: 6px;">Action Items</h3>
            <ol style="margin-left: 20px; line-height: 1.5;">
                <li><strong>Remove:</strong> Automatic screenshot capture code (captureVisibleTab logic)</li>
                <li><strong>Add:</strong> Drag-and-drop image upload to Phase 1</li>
                <li><strong>Implement:</strong> Follow 7-step plan above (4-6 hours)</li>
                <li><strong>Optional:</strong> Add file picker button (+1 hour)</li>
                <li><strong>Updated Timeline:</strong> Phase 1 becomes 24-34 hours (still manageable)</li>
            </ol>

            <div class="success" style="margin-top: 8px;">
                <strong>üéØ Recommendation: PROCEED with this approach.</strong> It's objectively better than automatic screenshots and solves the CORS problem elegantly.
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const collapsibles = document.querySelectorAll('.collapsible-header');
            collapsibles.forEach(header => {
                header.addEventListener('click', () => {
                    header.parentElement.classList.toggle('open');
                });
            });
            // Auto-open critical sections
            document.querySelectorAll('.collapsible.critical').forEach(el => {
                el.classList.add('open');
            });
        });
    </script>
</body>
</html>