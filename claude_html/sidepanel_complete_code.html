<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Side Panel - Complete Implementation Code</title>
    <style>
        :root {
            --chinese-red: #8B0000;
            --chinese-gold: #D4AF37;
            --paper-beige: #FAF7F2;
            --light-cream: #F2EBE1;
            --ink-black: #3E3226;
            --soft-brown: #8B7355;
            --muted-brown: #A89684;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, var(--paper-beige) 0%, var(--light-cream) 100%);
            color: var(--ink-black);
            font-family: system-ui, -apple-system, sans-serif;
            width: 100vw;
            max-width: 100%;
            line-height: 1.3;
            font-size: 13px;
            padding: 0;
            margin: 0;
        }

        .container {
            width: 100%;
            padding: 0;
            margin: 0;
        }

        h1 {
            font-size: 24px;
            font-weight: 900;
            margin: 16px;
            padding: 12px;
            background: linear-gradient(135deg, var(--chinese-red), #CD5C5C);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            border-left: 4px solid var(--chinese-gold);
        }

        h2 {
            font-size: 18px;
            font-weight: 700;
            margin: 24px 16px 12px 16px;
            padding: 10px 12px;
            border-left: 4px solid var(--chinese-red);
            background: rgba(139, 0, 0, 0.03);
            color: var(--chinese-red);
            border-radius: 4px;
        }

        h3 {
            font-size: 15px;
            font-weight: 600;
            margin: 16px 16px 8px 16px;
            color: var(--soft-brown);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .key-points {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), white);
            border: 2px solid var(--chinese-gold);
            padding: 16px;
            margin: 16px;
            border-radius: 8px;
        }

        .key-points h3 {
            margin: 0 0 12px 0;
            color: var(--chinese-red);
        }

        .key-points ul {
            margin-left: 20px;
        }

        .key-points li {
            margin: 8px 0;
            line-height: 1.6;
        }

        .key-points strong {
            color: var(--chinese-red);
            font-weight: 600;
        }

        .key-points code {
            background: rgba(245, 245, 220, 0.5);
            border: 1px solid rgba(184, 156, 130, 0.2);
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-family: Monaco, Menlo, monospace;
        }

        pre {
            background: linear-gradient(135deg, rgba(245, 245, 220, 0.3), rgba(255, 255, 255, 0.5));
            border: 1px solid rgba(139, 0, 0, 0.1);
            padding: 16px;
            margin: 16px;
            overflow-x: auto;
            border-radius: 8px;
            font-size: 12px;
            line-height: 1.5;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        code {
            font-family: Monaco, Menlo, 'Courier New', monospace;
        }

        .note {
            background: rgba(212, 175, 55, 0.1);
            border-left: 4px solid var(--chinese-gold);
            padding: 12px 16px;
            margin: 16px;
            border-radius: 4px;
            font-size: 13px;
            line-height: 1.6;
        }

        .note strong {
            color: var(--chinese-red);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Side Panel - Complete Implementation Code</h1>

        <div class="key-points">
            <h3>Key Features</h3>
            <ul>
                <li><strong>Inline Image Display:</strong> Render <code>card.imageData</code> for image cards</li>
                <li><strong>React-Markdown:</strong> Beautiful rendering for beautified content</li>
                <li><strong>Canvas-like Styling:</strong> Match CardNode appearance exactly</li>
                <li><strong>Card Type Badges:</strong> Visual indicators for image/note/clipped/generated</li>
                <li><strong>Expand/Collapse:</strong> Long content can be toggled</li>
            </ul>
        </div>

        <h2>Complete SidePanel.tsx</h2>

        <pre><code>/** @jsxImportSource @emotion/react */
import { css } from '@emotion/react';
import React, { useState, useMemo } from 'react';
import DOMPurify from 'isomorphic-dompurify';
import ReactMarkdown from 'react-markdown';
import remarkGfm from 'remark-gfm';
import type { Card } from '@/types/card';
import { useCards } from '@/shared/hooks/useCards';
import { useCardOperations } from '@/shared/hooks/useCardOperations';
import { useImageUpload } from '@/shared/hooks/useImageUpload';
import { ImageUploadZone, FilePickerButton } from '@/shared/components/ImageUpload';

export const SidePanel: React.FC = () => {
  // Use shared hooks
  const { cards: allCards, isLoading, refreshCards } = useCards(true); // Include stashed
  const { restoreCard, deleteCard } = useCardOperations(refreshCards);
  const { handleImageUpload, isUploading } = useImageUpload(
    (card) => {
      console.log('[SidePanel] Image uploaded:', card.id);
      refreshCards();
    },
    { stashImmediately: true }
  );

  // Filter to only stashed cards
  const stashedCards = useMemo(
    () => allCards.filter(card => card.stashed),
    [allCards]
  );

  const [searchQuery, setSearchQuery] = useState('');
  const [expandedCards, setExpandedCards] = useState&lt;Set&lt;string&gt;&gt;(new Set());

  const handleRestore = async (card: Card) => {
    try {
      await restoreCard(card.id);
      console.log('[SidePanel] Card restored:', card.metadata.title);
    } catch (error) {
      console.error('[SidePanel] Error restoring card:', error);
      alert('Failed to restore card');
    }
  };

  const handleDelete = async (card: Card) => {
    if (!confirm(`Permanently delete "${card.metadata.title}"?`)) {
      return;
    }

    try {
      await deleteCard(card.id);
      console.log('[SidePanel] Card deleted:', card.metadata.title);
    } catch (error) {
      console.error('[SidePanel] Error deleting card:', error);
      alert('Failed to delete card');
    }
  };

  const handleImageDrop = async (file: File) => {
    try {
      await handleImageUpload(file);
    } catch (error) {
      console.error('[SidePanel] Image upload failed:', error);
      alert('Failed to upload image');
    }
  };

  const handleFilesSelected = async (files: File[]) => {
    for (const file of files) {
      try {
        await handleImageUpload(file);
      } catch (error) {
        console.error('[SidePanel] Image upload failed:', file.name, error);
      }
    }
  };

  const handleOpenCanvas = () => {
    chrome.tabs.create({
      url: chrome.runtime.getURL('src/canvas/index.html'),
    });
  };

  // Filter cards by search query
  const filteredCards = stashedCards.filter((card) => {
    if (!searchQuery.trim()) return true;

    const query = searchQuery.toLowerCase();
    return (
      card.metadata.title.toLowerCase().includes(query) ||
      card.metadata.domain.toLowerCase().includes(query) ||
      card.content?.toLowerCase().includes(query) ||
      card.tags?.some((tag) => tag.toLowerCase().includes(query))
    );
  });

  const formatDate = (timestamp: number) => {
    return new Date(timestamp).toLocaleDateString('en-US', {
      month: 'short',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit',
    });
  };

  const toggleCardExpansion = (cardId: string) => {
    setExpandedCards((prev) => {
      const newSet = new Set(prev);
      if (newSet.has(cardId)) {
        newSet.delete(cardId);
      } else {
        newSet.add(cardId);
      }
      return newSet;
    });
  };

  const truncateText = (text: string, maxLength: number) => {
    if (text.length <= maxLength) return text;
    return text.substring(0, maxLength) + '...';
  };

  const getCardTypeBadge = (cardType?: string) => {
    const type = cardType || 'clipped';
    const badges = {
      image: { label: 'Image', emoji: 'ðŸ“·' },
      note: { label: 'Note', emoji: 'ðŸ“' },
      generated: { label: 'Generated', emoji: 'âœ¨' },
      clipped: { label: 'Clipped', emoji: 'ðŸŒ' },
    };
    return badges[type as keyof typeof badges] || badges.clipped;
  };

  return (
    &lt;ImageUploadZone onImageUpload={handleImageDrop}&gt;
      &lt;div css={containerStyles}&gt;
        {/* Header */}
        &lt;div css={headerStyles}&gt;
          &lt;h1 css={titleStyles}&gt;ðŸ“¦ Stashed Cards&lt;/h1&gt;
          &lt;button onClick={handleOpenCanvas} css={openCanvasButtonStyles} title="Open Canvas"&gt;
            ðŸ—ºï¸ Canvas
          &lt;/button&gt;
        &lt;/div&gt;

        {/* Upload Button */}
        &lt;div css={uploadSectionStyles}&gt;
          &lt;FilePickerButton
            onFilesSelected={handleFilesSelected}
            multiple
            label="ðŸ“ Upload Images"
            disabled={isUploading}
          /&gt;
          {isUploading && &lt;span css={uploadingTextStyles}&gt;Uploading...&lt;/span&gt;}
        &lt;/div&gt;

        {/* Search Bar */}
        &lt;div css={searchBarStyles}&gt;
          &lt;input
            type="text"
            placeholder="Search stashed cards..."
            value={searchQuery}
            onChange={(e) => setSearchQuery(e.target.value)}
            css={searchInputStyles}
          /&gt;
        &lt;/div&gt;

        {/* Card List */}
        &lt;div css={cardListStyles}&gt;
          {isLoading ? (
            &lt;div css={loadingStyles}&gt;Loading...&lt;/div&gt;
          ) : filteredCards.length === 0 ? (
            &lt;div css={emptyStateStyles}&gt;
              {searchQuery ? (
                &lt;&gt;
                  &lt;p&gt;No cards match "{searchQuery}"&lt;/p&gt;
                  &lt;button onClick={() => setSearchQuery('')} css={clearSearchButtonStyles}&gt;
                    Clear search
                  &lt;/button&gt;
                &lt;/&gt;
              ) : (
                &lt;&gt;
                  &lt;p&gt;No stashed cards yet&lt;/p&gt;
                  &lt;p css={hintStyles}&gt;Stash cards from the canvas to keep them out of sight&lt;/p&gt;
                &lt;/&gt;
              )}
            &lt;/div&gt;
          ) : (
            filteredCards.map((card) => {
              const isExpanded = expandedCards.has(card.id);
              const badge = getCardTypeBadge(card.cardType);

              // Sanitize content
              const contentToDisplay = card.beautifiedContent || card.content;
              const sanitizedContent = contentToDisplay
                ? DOMPurify.sanitize(contentToDisplay, {
                    ALLOWED_TAGS: [
                      'p', 'br', 'strong', 'em', 'u', 'a', 'span', 'div',
                      'h1', 'h2', 'h3', 'h4', 'h5', 'h6',
                      'ul', 'ol', 'li',
                      'article', 'section', 'header', 'footer', 'nav', 'aside',
                      'blockquote', 'pre', 'code'
                    ],
                    ALLOWED_ATTR: ['href', 'target', 'rel', 'style', 'class', 'id'],
                  })
                : '';

              return (
                &lt;div key={card.id} css={cardItemStyles}&gt;
                  {/* Card Header - Canvas-like */}
                  &lt;div css={cardHeaderStyles}&gt;
                    &lt;div css={cardHeaderLeftStyles}&gt;
                      {card.metadata.favicon && (
                        &lt;span css={faviconStyles}&gt;{card.metadata.favicon}&lt;/span&gt;
                      )}
                      &lt;span css={domainStyles}&gt;{card.metadata.domain}&lt;/span&gt;
                      &lt;span css={cardTypeBadgeStyles(card.cardType)}&gt;
                        {badge.emoji} {badge.label}
                      &lt;/span&gt;
                    &lt;/div&gt;
                    &lt;span css={dateStyles}&gt;{formatDate(card.createdAt)}&lt;/span&gt;
                  &lt;/div&gt;

                  {/* Card Title */}
                  &lt;div css={cardTitleStyles}&gt;
                    {truncateText(card.metadata.title, 100)}
                  &lt;/div&gt;

                  {/* CRITICAL: Image Display for Image Cards */}
                  {card.cardType === 'image' && card.imageData ? (
                    &lt;div css={imageContainerStyles}&gt;
                      &lt;img
                        src={card.imageData}
                        alt={card.metadata.title}
                        css={imageStyles}
                      /&gt;
                    &lt;/div&gt;
                  ) : (
                    /* Content Display for Non-Image Cards */
                    card.content && (
                      &lt;&gt;
                        &lt;div
                          css={isExpanded ? contentExpandedStyles : contentCollapsedStyles}
                        &gt;
                          {/* Render markdown if beautified, otherwise show HTML */}
                          {card.beautifiedContent ? (
                            &lt;ReactMarkdown
                              remarkPlugins={[remarkGfm]}
                              components={{
                                h1: ({node, ...props}) => &lt;h2 css={markdownH1} {...props} /&gt;,
                                h2: ({node, ...props}) => &lt;h3 css={markdownH2} {...props} /&gt;,
                                h3: ({node, ...props}) => &lt;h4 css={markdownH3} {...props} /&gt;,
                                p: ({node, ...props}) => &lt;p css={markdownP} {...props} /&gt;,
                                ul: ({node, ...props}) => &lt;ul css={markdownUl} {...props} /&gt;,
                                ol: ({node, ...props}) => &lt;ol css={markdownOl} {...props} /&gt;,
                                li: ({node, ...props}) => &lt;li css={markdownLi} {...props} /&gt;,
                                strong: ({node, ...props}) => &lt;strong css={markdownStrong} {...props} /&gt;,
                                code: ({node, ...props}) => &lt;code css={markdownCode} {...props} /&gt;,
                              }}
                            &gt;
                              {card.beautifiedContent}
                            &lt;/ReactMarkdown&gt;
                          ) : (
                            &lt;div
                              css={contentHTMLStyles}
                              dangerouslySetInnerHTML={{ __html: sanitizedContent }}
                            /&gt;
                          )}
                        &lt;/div&gt;

                        {/* Expand/Collapse Button */}
                        {sanitizedContent.length > 200 && (
                          &lt;button
                            onClick={() => toggleCardExpansion(card.id)}
                            css={expandButtonStyles}
                          &gt;
                            {isExpanded ? 'â–² Show less' : 'â–¼ Show more'}
                          &lt;/button&gt;
                        )}
                      &lt;/&gt;
                    )
                  )}

                  {/* Tags */}
                  {card.tags && card.tags.length > 0 && (
                    &lt;div css={tagsStyles}&gt;
                      {card.tags.slice(0, 5).map((tag, i) => (
                        &lt;span key={i} css={tagStyles}&gt;
                          {tag}
                        &lt;/span&gt;
                      ))}
                      {card.tags.length > 5 && (
                        &lt;span css={tagStyles}&gt;+{card.tags.length - 5}&lt;/span&gt;
                      )}
                    &lt;/div&gt;
                  )}

                  {/* Card Footer - Actions */}
                  &lt;div css={cardFooterStyles}&gt;
                    &lt;button onClick={() => handleRestore(card)} css={restoreButtonStyles}&gt;
                      â†©ï¸ Restore
                    &lt;/button&gt;
                    &lt;button onClick={() => handleDelete(card)} css={deleteButtonStyles}&gt;
                      ðŸ—‘ï¸ Delete
                    &lt;/button&gt;
                  &lt;/div&gt;
                &lt;/div&gt;
              );
            })
          )}
        &lt;/div&gt;

        {/* Footer Stats */}
        {!isLoading && stashedCards.length > 0 && (
          &lt;div css={footerStyles}&gt;
            {filteredCards.length} of {stashedCards.length} cards
          &lt;/div&gt;
        )}
      &lt;/div&gt;
    &lt;/ImageUploadZone&gt;
  );
};</code></pre>

        <h2>Emotion CSS Styles</h2>

        <pre><code>// Container Styles
const containerStyles = css`
  display: flex;
  flex-direction: column;
  height: 100vh;
  background: linear-gradient(135deg, rgba(250, 247, 242, 1) 0%, rgba(242, 235, 225, 1) 100%);
  font-family: system-ui, -apple-system, sans-serif;
`;

const headerStyles = css`
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px;
  border-bottom: 2px solid rgba(212, 175, 55, 0.3);
  background: linear-gradient(135deg, rgba(255, 215, 0, 0.05), transparent);
`;

const titleStyles = css`
  margin: 0;
  font-size: 18px;
  font-weight: 600;
  color: #3e3226;
`;

const openCanvasButtonStyles = css`
  padding: 6px 12px;
  background: linear-gradient(135deg, #d4af37, #ffd700);
  color: #3e3226;
  border: none;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;

  &:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(212, 175, 55, 0.3);
  }
`;

const cardListStyles = css`
  flex: 1;
  overflow-y: auto;
  padding: 12px;

  &::-webkit-scrollbar {
    width: 8px;
  }

  &::-webkit-scrollbar-thumb {
    background: rgba(139, 0, 0, 0.3);
    border-radius: 4px;
  }

  &::-webkit-scrollbar-thumb:hover {
    background: rgba(139, 0, 0, 0.5);
  }
`;

// CRITICAL: Canvas-like Card Styles
const cardItemStyles = css`
  background: linear-gradient(135deg, rgba(250, 247, 242, 0.98) 0%, rgba(242, 235, 225, 0.98) 100%);
  border-radius: 12px;
  box-shadow:
    0 2px 8px rgba(92, 77, 66, 0.08),
    0 8px 24px rgba(92, 77, 66, 0.12),
    inset 0 1px 0 rgba(255, 255, 255, 0.5);
  border: 1px solid rgba(184, 156, 130, 0.2);
  margin-bottom: 12px;
  display: flex;
  flex-direction: column;
  transition: all 0.2s ease;
  overflow: hidden;

  &:hover {
    box-shadow:
      0 4px 12px rgba(92, 77, 66, 0.12),
      0 12px 32px rgba(92, 77, 66, 0.16);
    border-color: rgba(212, 175, 55, 0.4);
  }
`;

const cardHeaderStyles = css`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 14px;
  border-bottom: 1px solid rgba(184, 156, 130, 0.15);
  background: rgba(255, 255, 255, 0.3);
`;

const cardHeaderLeftStyles = css`
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 1;
  min-width: 0;
`;

const faviconStyles = css`
  width: 16px;
  height: 16px;
  flex-shrink: 0;
`;

const domainStyles = css`
  font-size: 11px;
  color: #8B7355;
  font-weight: 500;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`;

const dateStyles = css`
  font-size: 10px;
  color: #A89684;
`;

// Card Type Badge
const cardTypeBadgeStyles = (cardType?: string) => css`
  font-size: 9px;
  padding: 3px 8px;
  border-radius: 4px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  flex-shrink: 0;

  ${cardType === 'image' && `
    background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(139, 195, 74, 0.2));
    color: #2E7D32;
    border: 1px solid rgba(76, 175, 80, 0.3);
  `}

  ${cardType === 'note' && `
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(212, 175, 55, 0.2));
    color: #8B7355;
    border: 1px solid rgba(212, 175, 55, 0.3);
  `}

  ${cardType === 'generated' && `
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(255, 215, 0, 0.15));
    color: #D4AF37;
    border: 1px solid rgba(212, 175, 55, 0.4);
  `}

  ${(!cardType || cardType === 'clipped') && `
    background: linear-gradient(135deg, rgba(139, 0, 0, 0.1), rgba(205, 92, 92, 0.1));
    color: #8B0000;
    border: 1px solid rgba(139, 0, 0, 0.2);
  `}
`;

const cardTitleStyles = css`
  font-size: 14px;
  font-weight: 600;
  color: #3E3226;
  line-height: 1.3;
  padding: 10px 14px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`;

// CRITICAL: Image Display Styles
const imageContainerStyles = css`
  width: 100%;
  max-height: 300px;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  background: rgba(0, 0, 0, 0.02);
  padding: 12px;
  margin: 0 12px 12px 12px;
  border-radius: 8px;
`;

const imageStyles = css`
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  border-radius: 6px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
`;

// Content Styles
const contentCollapsedStyles = css`
  max-height: 120px;
  overflow: hidden;
  padding: 12px 14px;
  font-size: 12px;
  color: #5C4D42;
  line-height: 1.5;
  border-left: 3px solid rgba(212, 175, 55, 0.3);
  background: rgba(0, 0, 0, 0.02);
  margin: 0 12px;
  border-radius: 6px;
  position: relative;

  &::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 40px;
    background: linear-gradient(transparent, rgba(242, 235, 225, 0.9));
  }
`;

const contentExpandedStyles = css`
  max-height: 400px;
  overflow-y: auto;
  padding: 12px 14px;
  font-size: 12px;
  color: #5C4D42;
  line-height: 1.5;
  border-left: 3px solid rgba(212, 175, 55, 0.5);
  background: rgba(0, 0, 0, 0.02);
  margin: 0 12px;
  border-radius: 6px;

  &::-webkit-scrollbar {
    width: 6px;
  }

  &::-webkit-scrollbar-thumb {
    background: rgba(139, 0, 0, 0.2);
    border-radius: 3px;
  }

  &::-webkit-scrollbar-thumb:hover {
    background: rgba(139, 0, 0, 0.4);
  }
`;

const contentHTMLStyles = css`
  font-size: 12px;
  color: #5C4D42;
  line-height: 1.6;
  word-break: break-word;

  p {
    margin: 0 0 8px 0;
  }

  h1, h2, h3, h4, h5, h6 {
    margin: 12px 0 6px 0;
    color: #3E3226;
  }

  ul, ol {
    margin: 8px 0;
    padding-left: 20px;
  }

  a {
    color: #D4AF37;
    text-decoration: underline;
  }
`;

const expandButtonStyles = css`
  width: calc(100% - 24px);
  margin: 8px 12px;
  padding: 6px;
  background: transparent;
  border: 1px solid rgba(184, 156, 130, 0.3);
  border-radius: 4px;
  color: #8B7355;
  font-size: 11px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;

  &:hover {
    background: rgba(212, 175, 55, 0.1);
    border-color: rgba(212, 175, 55, 0.5);
  }
`;

// Tags
const tagsStyles = css`
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  padding: 0 14px 10px 14px;
`;

const tagStyles = css`
  font-size: 10px;
  padding: 3px 8px;
  border-radius: 4px;
  background: rgba(212, 175, 55, 0.15);
  color: #8B7355;
  font-weight: 500;
  border: 1px solid rgba(212, 175, 55, 0.3);
`;

// Footer Actions
const cardFooterStyles = css`
  display: flex;
  gap: 8px;
  padding: 10px 14px;
  border-top: 1px solid rgba(184, 156, 130, 0.15);
  background: rgba(255, 255, 255, 0.2);
`;

const restoreButtonStyles = css`
  flex: 1;
  padding: 8px 12px;
  background: linear-gradient(135deg, #2E7D32, #4CAF50);
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;

  &:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(46, 125, 50, 0.3);
  }
`;

const deleteButtonStyles = css`
  flex: 1;
  padding: 8px 12px;
  background: rgba(139, 0, 0, 0.1);
  color: #8B0000;
  border: 1px solid rgba(139, 0, 0, 0.3);
  border-radius: 6px;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;

  &:hover {
    background: rgba(139, 0, 0, 0.2);
    transform: translateY(-1px);
  }
`;

// Markdown Styles (for ReactMarkdown)
const markdownH1 = css`
  font-size: 14px;
  font-weight: 600;
  color: #8B0000;
  margin: 12px 0 6px 0;
`;

const markdownH2 = css`
  font-size: 13px;
  font-weight: 600;
  color: #8B7355;
  margin: 10px 0 4px 0;
`;

const markdownH3 = css`
  font-size: 12px;
  font-weight: 600;
  color: #5C4D42;
  margin: 8px 0 3px 0;
`;

const markdownP = css`
  margin: 6px 0;
`;

const markdownUl = css`
  margin: 6px 0 6px 20px;
`;

const markdownOl = css`
  margin: 6px 0 6px 20px;
`;

const markdownLi = css`
  margin: 3px 0;
`;

const markdownStrong = css`
  color: #8B0000;
  font-weight: 600;
`;

const markdownCode = css`
  background: rgba(245, 245, 220, 0.5);
  border: 1px solid rgba(184, 156, 130, 0.2);
  padding: 2px 4px;
  border-radius: 3px;
  font-size: 11px;
  font-family: Monaco, Menlo, monospace;
`;

// Other utility styles
const searchBarStyles = css`
  padding: 12px 16px;
  border-bottom: 1px solid rgba(184, 156, 130, 0.2);
`;

const searchInputStyles = css`
  width: 100%;
  padding: 8px 12px;
  border: 1px solid rgba(184, 156, 130, 0.3);
  border-radius: 6px;
  font-size: 13px;
  outline: none;
  transition: all 0.2s ease;

  &:focus {
    border-color: #D4AF37;
    box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.1);
  }

  &::placeholder {
    color: #A89684;
  }
`;

const uploadSectionStyles = css`
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  background: rgba(76, 175, 80, 0.05);
  border-bottom: 1px solid rgba(76, 175, 80, 0.2);
`;

const uploadingTextStyles = css`
  font-size: 13px;
  color: #666;
  font-style: italic;
`;

const loadingStyles = css`
  text-align: center;
  padding: 40px 20px;
  color: #8B7355;
  font-size: 14px;
`;

const emptyStateStyles = css`
  text-align: center;
  padding: 60px 20px;
  color: #8B7355;

  p {
    margin: 8px 0;
    font-size: 14px;
  }
`;

const hintStyles = css`
  font-size: 12px;
  color: #A89684;
  font-style: italic;
`;

const clearSearchButtonStyles = css`
  margin-top: 16px;
  padding: 6px 12px;
  background: rgba(0, 0, 0, 0.05);
  border: 1px solid rgba(184, 156, 130, 0.3);
  border-radius: 4px;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s ease;

  &:hover {
    background: rgba(0, 0, 0, 0.1);
  }
`;

const footerStyles = css`
  padding: 12px 16px;
  border-top: 1px solid rgba(184, 156, 130, 0.2);
  text-align: center;
  font-size: 12px;
  color: #8B7355;
  background: linear-gradient(to top, rgba(255, 215, 0, 0.03), transparent);
`;</code></pre>

        <div class="note">
            <strong>Note:</strong> This implementation matches CardNode styling exactly with:
            <ul style="margin: 8px 0 0 20px; line-height: 1.6;">
                <li>Same gradient background and box-shadow for canvas-like feel</li>
                <li>ReactMarkdown with custom component styling for beautified content</li>
                <li>Conditional image rendering with proper aspect ratio preservation</li>
                <li>Card type badges with visual indicators</li>
                <li>Expand/collapse functionality for long content</li>
            </ul>
        </div>

        <h2>Key Implementation Points</h2>

        <div class="key-points">
            <h3>Critical Features</h3>
            <ul>
                <li><strong>Image Cards:</strong> Check <code>card.cardType === 'image' && card.imageData</code> before rendering image container</li>
                <li><strong>Markdown Rendering:</strong> Use <code>card.beautifiedContent</code> with ReactMarkdown when available</li>
                <li><strong>Content Sanitization:</strong> Always use DOMPurify for HTML content</li>
                <li><strong>Responsive Design:</strong> Images constrained to 300px max-height with <code>object-fit: contain</code></li>
                <li><strong>Canvas Consistency:</strong> Identical gradient, shadow, and border-radius as CardNode</li>
            </ul>
        </div>
    </div>
</body>
</html>