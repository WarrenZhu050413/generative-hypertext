<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatGPT App Extensions & FastMCP - Comprehensive Tutorial</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        :root {
            --chinese-red: #8B0000;
            --chinese-gold: #FFD700;
            --jade-green: #00A86B;
            --ink-black: #2B2B2B;
            --paper-beige: #F5F5DC;
            --light-cream: #FAFAF0;
            --level-1: #000;
            --level-2: #333;
            --level-3: #666;
            --level-4: #999;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, var(--paper-beige) 0%, var(--light-cream) 100%);
            color: var(--ink-black);
            margin: 0;
            padding: 12px;
            width: 100vw;
            max-width: 100%;
            line-height: 1.3;
            font-size: 14px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .container {
            width: 100%;
            max-width: 100%;
        }

        h1 {
            font-size: 28px;
            font-weight: 900;
            margin: 8px 0 12px 0;
            padding: 8px 12px;
            background: linear-gradient(135deg, var(--chinese-red), #CD5C5C);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
            border-bottom: 3px solid var(--chinese-gold);
        }

        h2 {
            font-size: 20px;
            font-weight: 700;
            margin: 12px 0 6px 0;
            padding: 6px 8px;
            border-left: 4px solid var(--chinese-red);
            background: rgba(139, 0, 0, 0.04);
            color: var(--level-1);
        }

        h3 {
            font-size: 16px;
            font-weight: 600;
            margin: 8px 0 4px 0;
            color: var(--level-2);
            padding-left: 8px;
            border-left: 2px solid var(--chinese-gold);
        }

        h4 {
            font-size: 14px;
            font-weight: 600;
            margin: 6px 0 3px 12px;
            color: var(--level-2);
        }

        .important-always-visible {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), white);
            border: 2px solid var(--chinese-gold);
            padding: 12px;
            margin: 12px 0;
            border-radius: 4px;
        }

        .important-always-visible h2 {
            color: var(--chinese-red);
            margin-top: 0;
            border: none;
            background: none;
            padding-left: 0;
        }

        .collapsible {
            margin: 6px 0;
            width: 100%;
        }

        .collapsible-header {
            cursor: pointer;
            padding: 8px 10px;
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.05), rgba(255, 215, 0, 0.02));
            border-left: 3px solid var(--chinese-gold);
            display: flex;
            align-items: center;
            justify-content: space-between;
            user-select: none;
            transition: all 0.2s ease;
            font-weight: 600;
            font-size: 15px;
        }

        .collapsible-header:hover {
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.1), rgba(255, 215, 0, 0.05));
        }

        .collapsible-header .arrow {
            display: inline-block;
            transition: transform 0.3s ease;
            color: var(--chinese-red);
            font-size: 12px;
            margin-right: 8px;
        }

        .collapsible.open .arrow {
            transform: rotate(90deg);
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            padding: 0 12px;
            margin-left: 12px;
        }

        .collapsible.open .collapsible-content {
            max-height: 10000px;
            padding: 12px;
        }

        .two-column-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin: 12px 0;
        }

        .two-column-layout > * {
            min-width: 0;
        }

        .full-width {
            grid-column: span 2;
        }

        pre {
            background: linear-gradient(135deg, rgba(43, 43, 43, 0.95), rgba(0, 0, 0, 0.9));
            border: 1px solid var(--chinese-gold);
            border-radius: 3px;
            padding: 12px;
            overflow-x: auto;
            margin: 8px 0;
            font-size: 13px;
            line-height: 1.4;
            color: #f8f8f2;
        }

        code {
            background: rgba(139, 0, 0, 0.08);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 13px;
            color: var(--chinese-red);
        }

        pre code {
            background: none;
            padding: 0;
            color: #f8f8f2;
        }

        .mermaid {
            background: white;
            padding: 16px;
            border: 2px solid var(--chinese-gold);
            border-radius: 4px;
            margin: 12px 0;
        }

        .card {
            background: white;
            border: 1px solid rgba(139, 0, 0, 0.2);
            border-radius: 4px;
            padding: 10px;
            margin: 8px 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .card.priority {
            border: 2px solid var(--chinese-red);
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.02), white);
        }

        .dense-list {
            list-style: none;
            padding: 0;
            margin: 8px 0 8px 12px;
        }

        .dense-list li {
            padding: 3px 0 3px 16px;
            border-left: 2px solid transparent;
            position: relative;
            line-height: 1.5;
        }

        .dense-list li:before {
            content: "▸";
            position: absolute;
            left: 0;
            color: var(--chinese-red);
            font-size: 12px;
        }

        .dense-list li strong {
            color: var(--level-1);
            font-weight: 600;
        }

        .divider {
            height: 1px;
            background: linear-gradient(90deg, var(--chinese-red), transparent);
            margin: 16px 0;
        }

        button, .button {
            background: linear-gradient(135deg, var(--chinese-red), #CD5C5C);
            color: white;
            border: 1px solid rgba(255, 215, 0, 0.3);
            padding: 6px 12px;
            margin: 4px;
            font-size: 13px;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        button:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(139, 0, 0, 0.3);
            border-color: var(--chinese-gold);
        }

        .badge {
            display: inline-block;
            background: var(--jade-green);
            color: white;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 8px;
        }

        .badge.warning {
            background: var(--chinese-gold);
            color: var(--ink-black);
        }

        .badge.critical {
            background: var(--chinese-red);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0;
            font-size: 13px;
        }

        th {
            background: var(--chinese-red);
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 6px 8px;
            border-bottom: 1px solid #ddd;
        }

        tr:nth-child(even) {
            background: rgba(245, 245, 220, 0.3);
        }

        .note {
            background: rgba(0, 168, 107, 0.1);
            border-left: 3px solid var(--jade-green);
            padding: 8px 12px;
            margin: 8px 0;
            font-size: 13px;
        }

        .warning {
            background: rgba(255, 215, 0, 0.1);
            border-left: 3px solid var(--chinese-gold);
            padding: 8px 12px;
            margin: 8px 0;
            font-size: 13px;
        }

        .expand-all, .collapse-all {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .collapse-all {
            right: 140px;
        }
    </style>
</head>
<body>
    <button class="expand-all" onclick="expandAll()">Expand All</button>
    <button class="collapse-all" onclick="collapseAll()">Collapse All</button>

    <div class="container">
        <h1>ChatGPT App Extensions & FastMCP Tutorial</h1>

        <div class="important-always-visible">
            <h2>Core Concepts</h2>
            <ul class="dense-list">
                <li><strong>ChatGPT Apps</strong> = MCP server (tools/resources) + ChatGPT model (selection/execution) + sandboxed iframe components (inline UX)</li>
                <li><strong>FastMCP</strong> = Python framework for rapid MCP server development with decorators, auth, and deployment tools</li>
                <li><strong>Architecture</strong> = Three cooperating layers standardized by Apps SDK (schema, transport, metadata)</li>
                <li><strong>Transport</strong> = Streamable HTTP or SSE for real-time tool execution</li>
                <li><strong>Components</strong> = React bundles using <code>window.openai</code> API for bidirectional communication</li>
            </ul>
        </div>

        <div class="divider"></div>

        <div class="mermaid">
graph TB
    subgraph "ChatGPT App Architecture"
        A[ChatGPT UI] -->|Discovers Tools| B[MCP Server]
        A -->|Executes Tool| B
        B -->|Returns Result + Template| A
        A -->|Renders Component| C[Sandboxed Iframe]
        C -->|window.openai API| A
        C -->|callTool| B
        B -->|Streaming Response| C
    end

    subgraph "FastMCP Server"
        B --> D[@mcp.tool decorators]
        B --> E[Auth Hooks]
        B --> F[Resources/Prompts]
        B --> G[HTTP Transport]
    end

    subgraph "Component Layer"
        C --> H[toolInput/toolOutput]
        C --> I[widgetState]
        C --> J[setWidgetState]
        C --> K[sendFollowupTurn]
    end

    style A fill:#FFD700,stroke:#8B0000,stroke-width:2px
    style B fill:#00A86B,stroke:#8B0000,stroke-width:2px
    style C fill:#F5F5DC,stroke:#FFD700,stroke-width:2px
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <div><span class="arrow">▶</span>1. Understanding ChatGPT Apps <span class="badge critical">CRITICAL</span></div>
            </div>
            <div class="collapsible-content">
                <h3>Three-Layer Architecture</h3>
                <div class="two-column-layout">
                    <div class="card priority">
                        <h4>Layer 1: MCP Server</h4>
                        <ul class="dense-list">
                            <li><strong>Purpose:</strong> Expose typed tools and resources</li>
                            <li><strong>Schema:</strong> JSON Schema for inputs/outputs</li>
                            <li><strong>Transport:</strong> HTTP or SSE with streaming</li>
                            <li><strong>Discovery:</strong> Rich metadata for ChatGPT</li>
                        </ul>
                    </div>
                    <div class="card priority">
                        <h4>Layer 2: ChatGPT Model</h4>
                        <ul class="dense-list">
                            <li><strong>Selection:</strong> Chooses appropriate tools</li>
                            <li><strong>Execution:</strong> Invokes tools with context</li>
                            <li><strong>Narration:</strong> Explains results to user</li>
                            <li><strong>Orchestration:</strong> Multi-tool workflows</li>
                        </ul>
                    </div>
                </div>
                <div class="card priority full-width">
                    <h4>Layer 3: Sandboxed Components</h4>
                    <ul class="dense-list">
                        <li><strong>Iframe isolation:</strong> Security boundary for custom UI</li>
                        <li><strong>window.openai API:</strong> Bidirectional communication channel</li>
                        <li><strong>React 18:</strong> Component framework (esbuild bundling)</li>
                        <li><strong>Templates:</strong> HTML/CSS/JS linked via metadata</li>
                    </ul>
                </div>

                <div class="warning">
                    <strong>Developer Mode Required:</strong> Settings → Connectors → Advanced to enable HTTPS MCP connectors in ChatGPT conversations.
                </div>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <div><span class="arrow">▶</span>2. FastMCP Deep Dive <span class="badge critical">CRITICAL</span></div>
            </div>
            <div class="collapsible-content">
                <h3>What is FastMCP?</h3>
                <p style="margin: 8px 0; line-height: 1.5;">FastMCP is a high-level Python framework for building MCP servers. It provides decorator-based tool registration, automatic schema generation, transport configuration, auth hooks, and deployment helpers—all optimized for ChatGPT Apps while maintaining compatibility with other MCP clients.</p>

                <div class="mermaid">
graph LR
    A[Python Function] -->|@mcp.tool| B[FastMCP Server]
    B -->|Auto Schema| C[JSON Schema]
    B -->|Transport| D[HTTP/SSE Endpoint]
    D -->|Apps SDK| E[ChatGPT]
    E -->|Tool Call| D
    D -->|Response| F[Component]

    style B fill:#00A86B,stroke:#8B0000,stroke-width:2px
    style E fill:#FFD700,stroke:#8B0000,stroke-width:2px
                </div>

                <h3>Key Features</h3>
                <div class="two-column-layout">
                    <div class="card">
                        <h4>🚀 Rapid Development</h4>
                        <ul class="dense-list">
                            <li>Decorator-based tool registration</li>
                            <li>Automatic JSON Schema generation</li>
                            <li>Type hints → Schema validation</li>
                            <li>Hot reload during development</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>🔐 Enterprise Auth</h4>
                        <ul class="dense-list">
                            <li>OAuth 2.1 + PKCE flows</li>
                            <li>Protected resource metadata</li>
                            <li>Token verification helpers</li>
                            <li>AuthSettings configuration</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>🌐 Transport & Deployment</h4>
                        <ul class="dense-list">
                            <li>Streamable HTTP out-of-box</li>
                            <li>SSE support for real-time</li>
                            <li>Low cold-start optimizations</li>
                            <li>Fly.io / Render / Cloud Run ready</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>📦 Production Tooling</h4>
                        <ul class="dense-list">
                            <li>Server composition patterns</li>
                            <li>OpenAPI/FastAPI generation</li>
                            <li>Automated documentation</li>
                            <li>Client library support</li>
                        </ul>
                    </div>
                </div>

                <h3>Installation & Setup</h3>
                <pre><code># Install FastMCP
pip install fastmcp

# With development dependencies
pip install "fastmcp[dev]"

# Latest from GitHub
pip install git+https://github.com/jlowin/fastmcp.git</code></pre>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <div><span class="arrow">▶</span>3. Building Your First App <span class="badge">HANDS-ON</span></div>
            </div>
            <div class="collapsible-content">
                <h3>Step-by-Step Guide</h3>

                <div class="card priority">
                    <h4>Step 1: Scope Your Tool</h4>
                    <p style="margin: 8px 0;">Define what your tool does, its inputs/outputs, and whether it needs custom UI.</p>
                    <pre><code># Example: Dice roller tool
# Input: number of sides (int)
# Output: rolled value (int)
# UI: Optional visual dice animation</code></pre>
                </div>

                <div class="card priority">
                    <h4>Step 2: Create FastMCP Server</h4>
                    <pre><code>from fastmcp import FastMCP
import random

mcp = FastMCP("Dice Roller Server")

@mcp.tool
def roll_dice(sides: int = 6) -> int:
    """Roll a dice with the specified number of sides.

    Args:
        sides: Number of sides on the dice (default: 6)

    Returns:
        The rolled value between 1 and sides
    """
    return random.randint(1, sides)

@mcp.tool
def roll_multiple(count: int, sides: int = 6) -> list[int]:
    """Roll multiple dice and return all results.

    Args:
        count: Number of dice to roll
        sides: Number of sides per dice

    Returns:
        List of rolled values
    """
    return [random.randint(1, sides) for _ in range(count)]

if __name__ == "__main__":
    # Run with HTTP transport on port 8000
    mcp.run(transport="http", port=8000)</code></pre>
                </div>

                <div class="card priority">
                    <h4>Step 3: Test Locally</h4>
                    <pre><code># Run server
python server.py

# In another terminal, use MCP Inspector
npx @modelcontextprotocol/inspector

# Or test with curl
curl http://localhost:8000/mcp \
  -H "Content-Type: application/json" \
  -d '{"jsonrpc":"2.0","id":1,"method":"tools/list"}'</code></pre>
                </div>

                <div class="card priority">
                    <h4>Step 4: Add Component (Optional)</h4>
                    <pre><code>// components/DiceVisual.jsx
import React, { useEffect, useState } from 'react';

function DiceVisual() {
  const [result, setResult] = useState(null);

  useEffect(() => {
    // Listen for tool output
    const handler = (event) => {
      if (event.data.type === 'openai:tool_response') {
        setResult(event.data.toolOutput);
      }
    };

    window.addEventListener('message', handler);
    return () => window.removeEventListener('message', handler);
  }, []);

  const rollAgain = () => {
    window.openai.callTool('roll_dice', {
      sides: window.openai.toolInput.sides
    });
  };

  return (
    &lt;div style={{ textAlign: 'center', padding: '20px' }}&gt;
      &lt;div className="dice-face"&gt;
        {result !== null ? `🎲 ${result}` : '🎲'}
      &lt;/div&gt;
      &lt;button onClick={rollAgain}&gt;Roll Again&lt;/button&gt;
    &lt;/div&gt;
  );
}

export default DiceVisual;</code></pre>
                </div>

                <div class="card priority">
                    <h4>Step 5: Link Component to Tool</h4>
                    <pre><code>from fastmcp import FastMCP
import random

mcp = FastMCP("Dice Roller Server")

@mcp.tool
def roll_dice(sides: int = 6) -> dict:
    """Roll a dice with visual component."""
    result = random.randint(1, sides)

    return {
        "value": result,
        "_meta": {
            "openai/outputTemplate": {
                "type": "text/html+skybridge",
                "url": "https://your-cdn.com/dice-visual.html"
            },
            "openai/widgetAccessible": True,
            "openai/widgetPrefersBorder": True
        }
    }</code></pre>
                </div>

                <div class="card priority">
                    <h4>Step 6: Deploy to HTTPS</h4>
                    <pre><code># Option 1: Ngrok for testing
ngrok http 8000

# Option 2: Fly.io deployment
fly launch
fly deploy

# Option 3: Render
# Connect GitHub repo, set start command:
# python server.py

# Option 4: Cloud Run
gcloud run deploy dice-server \
  --source . \
  --allow-unauthenticated</code></pre>
                </div>

                <div class="card priority">
                    <h4>Step 7: Connect to ChatGPT</h4>
                    <div class="note">
                        <strong>Steps:</strong>
                        <ol style="margin: 8px 0 0 20px;">
                            <li>Open ChatGPT Settings</li>
                            <li>Navigate to Connectors → Advanced</li>
                            <li>Enable Developer Mode</li>
                            <li>Add your HTTPS endpoint</li>
                            <li>Toggle connector in chat</li>
                            <li>Test: "Roll a 20-sided dice"</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <div><span class="arrow">▶</span>4. window.openai API Reference <span class="badge critical">CRITICAL</span></div>
            </div>
            <div class="collapsible-content">
                <h3>Global Properties</h3>
                <table>
                    <tr>
                        <th>Property</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><code>window.openai.toolInput</code></td>
                        <td>object</td>
                        <td>Input parameters passed to the tool</td>
                    </tr>
                    <tr>
                        <td><code>window.openai.toolOutput</code></td>
                        <td>object</td>
                        <td>Result returned from tool execution</td>
                    </tr>
                    <tr>
                        <td><code>window.openai.widgetState</code></td>
                        <td>object</td>
                        <td>Persistent state across component lifecycle</td>
                    </tr>
                    <tr>
                        <td><code>window.openai.displayMode</code></td>
                        <td>string</td>
                        <td>"inline" | "fullscreen" | "minimal"</td>
                    </tr>
                    <tr>
                        <td><code>window.openai.maxHeight</code></td>
                        <td>number</td>
                        <td>Maximum height constraint in pixels</td>
                    </tr>
                    <tr>
                        <td><code>window.openai.theme</code></td>
                        <td>object</td>
                        <td>ChatGPT theme colors (light/dark)</td>
                    </tr>
                </table>

                <h3>Action Methods</h3>
                <table>
                    <tr>
                        <th>Method</th>
                        <th>Parameters</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><code>setWidgetState(state)</code></td>
                        <td>object</td>
                        <td>Persist conversational state</td>
                    </tr>
                    <tr>
                        <td><code>callTool(name, args)</code></td>
                        <td>string, object</td>
                        <td>Invoke server tool from component</td>
                    </tr>
                    <tr>
                        <td><code>sendFollowupTurn(msg)</code></td>
                        <td>string</td>
                        <td>Add system message to transcript</td>
                    </tr>
                    <tr>
                        <td><code>requestDisplayMode(mode)</code></td>
                        <td>string</td>
                        <td>Request layout change (hint only)</td>
                    </tr>
                </table>

                <h3>Event Listeners</h3>
                <pre><code>// Listen for global updates
window.addEventListener('message', (event) => {
  if (event.data.type === 'openai:set_globals') {
    const { displayMode, maxHeight, theme } = event.data;
    // Update component layout
  }
});

// Listen for tool responses
window.addEventListener('message', (event) => {
  if (event.data.type === 'openai:tool_response') {
    const { toolName, toolOutput } = event.data;
    // Handle background tool completion
  }
});</code></pre>

                <h3>Complete Component Example</h3>
                <pre><code>import React, { useEffect, useState } from 'react';

function SearchResults() {
  const [results, setResults] = useState([]);
  const [loading, setLoading] = useState(false);
  const [theme, setTheme] = useState('light');

  useEffect(() => {
    // Initialize with tool output
    if (window.openai?.toolOutput?.results) {
      setResults(window.openai.toolOutput.results);
    }

    // Restore widget state
    if (window.openai?.widgetState?.selectedItems) {
      // Restore previous selections
    }

    // Listen for theme changes
    const handleMessage = (event) => {
      if (event.data.type === 'openai:set_globals') {
        setTheme(event.data.theme?.mode || 'light');
      }

      if (event.data.type === 'openai:tool_response') {
        if (event.data.toolName === 'search') {
          setResults(event.data.toolOutput.results);
          setLoading(false);
        }
      }
    };

    window.addEventListener('message', handleMessage);
    return () => window.removeEventListener('message', handleMessage);
  }, []);

  const handleSearch = (query) => {
    setLoading(true);
    window.openai.callTool('search', { query });
  };

  const handleSelect = (item) => {
    // Persist selection in widget state
    window.openai.setWidgetState({
      selectedItems: [...(window.openai.widgetState?.selectedItems || []), item]
    });

    // Notify ChatGPT
    window.openai.sendFollowupTurn(`User selected: ${item.title}`);
  };

  return (
    &lt;div style={{
      background: theme === 'dark' ? '#2b2b2b' : '#fff',
      color: theme === 'dark' ? '#fff' : '#2b2b2b'
    }}&gt;
      {loading && &lt;div&gt;Loading...&lt;/div&gt;}
      {results.map(item =&gt; (
        &lt;div key={item.id} onClick={() =&gt; handleSelect(item)}&gt;
          &lt;h3&gt;{item.title}&lt;/h3&gt;
          &lt;p&gt;{item.description}&lt;/p&gt;
        &lt;/div&gt;
      ))}
    &lt;/div&gt;
  );
}</code></pre>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <div><span class="arrow">▶</span>5. Advanced Patterns <span class="badge">INTERMEDIATE</span></div>
            </div>
            <div class="collapsible-content">
                <h3>Multi-Tool Workflows</h3>
                <pre><code>from fastmcp import FastMCP

mcp = FastMCP("E-commerce Server")

@mcp.tool
def search_products(query: str) -> list[dict]:
    """Search for products matching query."""
    # Implementation
    return [{"id": 1, "name": "Product", "price": 29.99}]

@mcp.tool
def get_product_details(product_id: int) -> dict:
    """Get detailed information about a product."""
    # Implementation
    return {"id": product_id, "reviews": [...], "specs": {...}}

@mcp.tool
def add_to_cart(product_id: int, quantity: int = 1) -> dict:
    """Add product to shopping cart."""
    # Implementation
    return {"cart_id": "abc123", "total": 59.98}

@mcp.tool
def checkout(cart_id: str) -> dict:
    """Complete purchase of cart items."""
    # Implementation with component
    return {
        "order_id": "ORD-12345",
        "status": "confirmed",
        "_meta": {
            "openai/outputTemplate": {
                "type": "text/html+skybridge",
                "url": "https://cdn.example.com/checkout-confirmation.html"
            }
        }
    }</code></pre>

                <h3>Authentication Flow</h3>
                <pre><code>from fastmcp import FastMCP, AuthSettings

# Configure OAuth 2.1 + PKCE
auth = AuthSettings(
    authorization_url="https://auth.example.com/oauth/authorize",
    token_url="https://auth.example.com/oauth/token",
    client_id="your-client-id",
    scopes=["read:data", "write:data"],
    pkce=True
)

mcp = FastMCP("Protected Server", auth=auth)

@mcp.tool
def get_user_data(user_id: str, token: str) -> dict:
    """Get user data (requires authentication).

    This tool automatically triggers OAuth flow if token is missing.
    """
    # Verify token
    if not verify_token(token):
        raise ValueError("Invalid token")

    # Fetch protected resource
    return {"user_id": user_id, "data": {...}}

def verify_token(token: str) -> bool:
    # Token verification logic
    return True</code></pre>

                <h3>Streaming Responses</h3>
                <pre><code>from fastmcp import FastMCP
import asyncio

mcp = FastMCP("Streaming Server")

@mcp.tool
async def generate_report(data_size: str) -> dict:
    """Generate a large report with streaming updates."""

    async def stream_progress():
        for i in range(0, 101, 10):
            yield {
                "progress": i,
                "status": f"Processing... {i}%"
            }
            await asyncio.sleep(0.5)

        yield {
            "progress": 100,
            "status": "Complete",
            "report_url": "https://example.com/report.pdf"
        }

    # Return async generator for streaming
    return {
        "stream": stream_progress(),
        "_meta": {
            "openai/outputTemplate": {
                "type": "text/html+skybridge",
                "url": "https://cdn.example.com/progress-bar.html"
            }
        }
    }</code></pre>

                <h3>Resource Management</h3>
                <pre><code>from fastmcp import FastMCP

mcp = FastMCP("Document Server")

# Register resources (templates, data, prompts)
@mcp.resource("template://search-results")
def search_results_template():
    """HTML template for search results display."""
    return {
        "content": "&lt;html&gt;...&lt;/html&gt;",
        "mimeType": "text/html"
    }

@mcp.resource("data://user-preferences")
def user_preferences(user_id: str):
    """Get user preferences for personalization."""
    return {
        "theme": "dark",
        "language": "en",
        "notifications": True
    }

@mcp.prompt("system-prompt")
def system_prompt():
    """System prompt for tool usage guidance."""
    return """
    You are a helpful shopping assistant. Use the available tools to:
    1. Search for products when users describe what they want
    2. Get details when users ask about specific products
    3. Add items to cart when users express purchase intent
    4. Complete checkout when users are ready to buy
    """</code></pre>

                <h3>Error Handling</h3>
                <pre><code>from fastmcp import FastMCP
from fastmcp.exceptions import ToolError

mcp = FastMCP("Robust Server")

@mcp.tool
def risky_operation(value: int) -> dict:
    """Perform operation that might fail."""
    try:
        if value &lt; 0:
            raise ValueError("Value must be positive")

        result = perform_operation(value)

        return {
            "success": True,
            "result": result
        }

    except ValueError as e:
        # User error - provide helpful message
        raise ToolError(
            message=str(e),
            code="INVALID_INPUT",
            recoverable=True
        )

    except Exception as e:
        # Server error - log and return generic message
        logger.error(f"Operation failed: {e}")
        raise ToolError(
            message="Operation failed. Please try again.",
            code="INTERNAL_ERROR",
            recoverable=False
        )

def perform_operation(value: int):
    # Implementation
    return value * 2</code></pre>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <div><span class="arrow">▶</span>6. Production Best Practices <span class="badge warning">IMPORTANT</span></div>
            </div>
            <div class="collapsible-content">
                <h3>Design Principles</h3>
                <div class="card priority">
                    <h4>🎯 Inline-First Experiences</h4>
                    <ul class="dense-list">
                        <li>Design for 300-500px width initially</li>
                        <li>Implement responsive breakpoints for all sizes</li>
                        <li>Provide clear empty states and loading indicators</li>
                        <li>Ensure accessibility (keyboard nav, screen readers)</li>
                        <li>Test in both light and dark themes</li>
                    </ul>
                </div>

                <h3>Performance Optimization</h3>
                <ul class="dense-list">
                    <li><strong>Cold start latency:</strong> Keep server initialization under 2 seconds</li>
                    <li><strong>Bundle size:</strong> Components should be &lt; 200KB compressed</li>
                    <li><strong>Lazy loading:</strong> Split large components with dynamic imports</li>
                    <li><strong>Caching:</strong> Implement HTTP caching headers for static assets</li>
                    <li><strong>CDN delivery:</strong> Host components on CDN for global distribution</li>
                </ul>

                <h3>Versioning Strategy</h3>
                <pre><code># Version assets by minting new URIs
{
    "_meta": {
        "openai/outputTemplate": {
            "type": "text/html+skybridge",
            "url": "https://cdn.example.com/component-v2.3.1.html"
        }
    }
}

# Avoid cached mismatches by using content hashes
url: "https://cdn.example.com/component-a3f5d9c2.html"</code></pre>

                <h3>Observability & Analytics</h3>
                <pre><code>from fastmcp import FastMCP
import logging
from datetime import datetime

logger = logging.getLogger(__name__)

mcp = FastMCP("Production Server")

@mcp.tool
def tracked_search(query: str, user_id: str = None) -> dict:
    """Search with full analytics instrumentation."""

    # Generate tool call ID for tracking
    call_id = f"search-{datetime.now().timestamp()}"

    # Log tool invocation
    logger.info(f"Tool call: {call_id}", extra={
        "tool": "tracked_search",
        "query": query,
        "user_id": user_id,
        "timestamp": datetime.now().isoformat()
    })

    try:
        results = perform_search(query)

        # Log success metrics
        logger.info(f"Tool success: {call_id}", extra={
            "result_count": len(results),
            "latency_ms": 150
        })

        return {
            "results": results,
            "_analytics": {
                "call_id": call_id,
                "result_count": len(results)
            }
        }

    except Exception as e:
        # Log errors for debugging
        logger.error(f"Tool error: {call_id}", extra={
            "error": str(e),
            "query": query
        })
        raise

def perform_search(query: str):
    return [{"id": 1, "title": "Result"}]</code></pre>

                <h3>Security Checklist</h3>
                <div class="warning">
                    <strong>⚠️ Critical Security Requirements:</strong>
                    <ul class="dense-list" style="margin-top: 8px;">
                        <li>✓ Validate all inputs with JSON Schema</li>
                        <li>✓ Sanitize outputs to prevent XSS</li>
                        <li>✓ Implement rate limiting per user/IP</li>
                        <li>✓ Use OAuth for write-capable tools</li>
                        <li>✓ Require confirmation for destructive actions</li>
                        <li>✓ Set CSP headers in component HTML</li>
                        <li>✓ Audit dependencies for vulnerabilities</li>
                        <li>✓ Log security events (auth failures, etc.)</li>
                    </ul>
                </div>

                <h3>Deployment Architectures</h3>
                <div class="mermaid">
graph TB
    subgraph "Production Stack"
        A[Load Balancer] --> B[FastMCP Pod 1]
        A --> C[FastMCP Pod 2]
        A --> D[FastMCP Pod N]

        B --> E[Redis Cache]
        C --> E
        D --> E

        B --> F[PostgreSQL]
        C --> F
        D --> F

        B --> G[OAuth Service]
        C --> G
        D --> G
    end

    subgraph "CDN Layer"
        H[CloudFlare CDN] --> I[Component Assets]
        H --> J[Static Resources]
    end

    K[ChatGPT] -->|HTTPS| A
    K -->|Component Load| H

    style K fill:#FFD700,stroke:#8B0000,stroke-width:2px
    style A fill:#00A86B,stroke:#8B0000,stroke-width:2px
                </div>

                <h3>Testing Strategy</h3>
                <pre><code># Unit tests for tools
import pytest
from server import mcp

def test_roll_dice():
    result = mcp.tools["roll_dice"](sides=6)
    assert 1 &lt;= result &lt;= 6

def test_roll_dice_schema():
    schema = mcp.get_tool_schema("roll_dice")
    assert schema["parameters"]["properties"]["sides"]["type"] == "integer"

# Integration tests with MCP Inspector
# playwright test mcp-integration.spec.ts

# E2E tests with ChatGPT
# Manual testing checklist:
# 1. Tool discovery works
# 2. Tool execution returns expected format
# 3. Component renders correctly
# 4. window.openai API functions properly
# 5. Error states display appropriately
# 6. Authentication flow completes
# 7. Multi-tool workflows execute in sequence</code></pre>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <div><span class="arrow">▶</span>7. Real-World Examples <span class="badge">PRACTICAL</span></div>
            </div>
            <div class="collapsible-content">
                <h3>Example 1: Weather App</h3>
                <pre><code>from fastmcp import FastMCP
import requests

mcp = FastMCP("Weather Assistant")

@mcp.tool
def get_weather(city: str, units: str = "metric") -> dict:
    """Get current weather for a city with visual display.

    Args:
        city: City name (e.g., "San Francisco")
        units: Temperature units ("metric" or "imperial")
    """
    # Fetch from weather API
    api_key = os.getenv("WEATHER_API_KEY")
    response = requests.get(
        f"https://api.weather.com/v1/weather/{city}",
        params={"units": units, "key": api_key}
    )

    data = response.json()

    return {
        "temperature": data["temp"],
        "condition": data["condition"],
        "humidity": data["humidity"],
        "wind_speed": data["wind_speed"],
        "city": city,
        "_meta": {
            "openai/outputTemplate": {
                "type": "text/html+skybridge",
                "url": "https://cdn.example.com/weather-card.html"
            },
            "openai/widgetAccessible": True
        }
    }

@mcp.tool
def get_forecast(city: str, days: int = 7) -> dict:
    """Get weather forecast for multiple days."""
    # Implementation
    return {
        "city": city,
        "forecast": [...],
        "_meta": {
            "openai/outputTemplate": {
                "type": "text/html+skybridge",
                "url": "https://cdn.example.com/forecast-chart.html"
            }
        }
    }</code></pre>

                <h3>Example 2: Task Management</h3>
                <pre><code>from fastmcp import FastMCP
from datetime import datetime

mcp = FastMCP("Task Manager")

tasks = []  # In production: use database

@mcp.tool
def create_task(title: str, due_date: str = None, priority: str = "medium") -> dict:
    """Create a new task with optional due date and priority."""
    task = {
        "id": len(tasks) + 1,
        "title": title,
        "due_date": due_date,
        "priority": priority,
        "completed": False,
        "created_at": datetime.now().isoformat()
    }
    tasks.append(task)

    return {
        "task": task,
        "message": f"Created task: {title}",
        "_meta": {
            "openai/outputTemplate": {
                "type": "text/html+skybridge",
                "url": "https://cdn.example.com/task-card.html"
            }
        }
    }

@mcp.tool
def list_tasks(filter_by: str = "all") -> dict:
    """List all tasks with optional filtering.

    Args:
        filter_by: "all", "pending", "completed", "overdue"
    """
    filtered = tasks

    if filter_by == "pending":
        filtered = [t for t in tasks if not t["completed"]]
    elif filter_by == "completed":
        filtered = [t for t in tasks if t["completed"]]
    elif filter_by == "overdue":
        now = datetime.now()
        filtered = [t for t in tasks if not t["completed"] and
                   t["due_date"] and datetime.fromisoformat(t["due_date"]) &lt; now]

    return {
        "tasks": filtered,
        "count": len(filtered),
        "_meta": {
            "openai/outputTemplate": {
                "type": "text/html+skybridge",
                "url": "https://cdn.example.com/task-list.html"
            }
        }
    }

@mcp.tool
def complete_task(task_id: int) -> dict:
    """Mark a task as completed."""
    task = next((t for t in tasks if t["id"] == task_id), None)

    if not task:
        raise ValueError(f"Task {task_id} not found")

    task["completed"] = True
    task["completed_at"] = datetime.now().isoformat()

    return {
        "task": task,
        "message": f"Completed: {task['title']}"
    }</code></pre>

                <h3>Example 3: Data Visualization</h3>
                <pre><code>from fastmcp import FastMCP
import pandas as pd
import json

mcp = FastMCP("Data Visualizer")

@mcp.tool
def analyze_dataset(csv_url: str, chart_type: str = "bar") -> dict:
    """Analyze CSV data and create interactive visualization.

    Args:
        csv_url: URL to CSV file
        chart_type: "bar", "line", "scatter", "pie"
    """
    # Load and analyze data
    df = pd.read_csv(csv_url)

    summary = {
        "rows": len(df),
        "columns": list(df.columns),
        "numeric_stats": df.describe().to_dict(),
        "chart_data": df.to_dict('records')
    }

    return {
        "summary": summary,
        "chart_type": chart_type,
        "_meta": {
            "openai/outputTemplate": {
                "type": "text/html+skybridge",
                "url": f"https://cdn.example.com/chart-{chart_type}.html"
            },
            "openai/widgetPrefersBorder": True
        }
    }

@mcp.tool
def create_dashboard(dataset_ids: list[str]) -> dict:
    """Create multi-chart dashboard from multiple datasets."""
    charts = []

    for dataset_id in dataset_ids:
        # Load dataset and create chart config
        charts.append({
            "id": dataset_id,
            "type": "line",
            "data": [...]
        })

    return {
        "charts": charts,
        "_meta": {
            "openai/outputTemplate": {
                "type": "text/html+skybridge",
                "url": "https://cdn.example.com/dashboard.html"
            },
            "openai/widgetAccessible": True
        }
    }</code></pre>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <div><span class="arrow">▶</span>8. Component Development Guide <span class="badge">ADVANCED</span></div>
            </div>
            <div class="collapsible-content">
                <h3>React Component Structure</h3>
                <pre><code>// src/components/MyComponent.jsx
import React, { useEffect, useState } from 'react';
import './MyComponent.css';

function MyComponent() {
  // State management
  const [data, setData] = useState(null);
  const [theme, setTheme] = useState('light');
  const [displayMode, setDisplayMode] = useState('inline');

  // Initialize from window.openai
  useEffect(() => {
    if (window.openai?.toolOutput) {
      setData(window.openai.toolOutput);
    }

    if (window.openai?.theme) {
      setTheme(window.openai.theme.mode);
    }

    if (window.openai?.displayMode) {
      setDisplayMode(window.openai.displayMode);
    }
  }, []);

  // Listen for updates
  useEffect(() => {
    const handleMessage = (event) => {
      if (event.data.type === 'openai:set_globals') {
        setTheme(event.data.theme?.mode || 'light');
        setDisplayMode(event.data.displayMode || 'inline');
      }

      if (event.data.type === 'openai:tool_response') {
        setData(event.data.toolOutput);
      }
    };

    window.addEventListener('message', handleMessage);
    return () => window.removeEventListener('message', handleMessage);
  }, []);

  // Handlers
  const handleAction = () => {
    window.openai.callTool('my_tool', { param: 'value' });
  };

  const handleStateChange = (newState) => {
    window.openai.setWidgetState({ ...newState });
  };

  // Render
  return (
    &lt;div className={`my-component ${theme} ${displayMode}`}&gt;
      {/* Component content */}
    &lt;/div&gt;
  );
}

export default MyComponent;</code></pre>

                <h3>Build Configuration</h3>
                <pre><code>// vite.config.js
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  build: {
    outDir: 'dist',
    lib: {
      entry: 'src/index.jsx',
      formats: ['iife'],
      name: 'MyComponent',
      fileName: () => 'component.js'
    },
    rollupOptions: {
      external: [],
      output: {
        inlineDynamicImports: true
      }
    }
  }
});

// package.json
{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0"
  },
  "devDependencies": {
    "@vitejs/plugin-react": "^4.0.0",
    "vite": "^4.3.0"
  }
}</code></pre>

                <h3>HTML Wrapper Template</h3>
                <pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8"&gt;
  &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
  &lt;meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self' 'unsafe-inline'"&gt;
  &lt;title&gt;My Component&lt;/title&gt;
  &lt;style&gt;
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, sans-serif; }
    .my-component { padding: 16px; }
    .my-component.dark { background: #2b2b2b; color: #fff; }
    .my-component.light { background: #fff; color: #2b2b2b; }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id="root"&gt;&lt;/div&gt;
  &lt;script src="component.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>

                <h3>Responsive Design</h3>
                <pre><code>/* MyComponent.css */
.my-component {
  width: 100%;
  min-height: 200px;
  max-height: 600px;
  overflow-y: auto;
}

/* Inline mode - compact layout */
.my-component.inline {
  padding: 12px;
  font-size: 14px;
}

/* Fullscreen mode - spacious layout */
.my-component.fullscreen {
  padding: 24px;
  font-size: 16px;
}

/* Responsive breakpoints */
@media (max-width: 400px) {
  .my-component {
    padding: 8px;
    font-size: 12px;
  }
}

@media (min-width: 800px) {
  .my-component {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
  }
}</code></pre>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <div><span class="arrow">▶</span>9. Troubleshooting & Debugging <span class="badge warning">IMPORTANT</span></div>
            </div>
            <div class="collapsible-content">
                <h3>Common Issues</h3>

                <div class="card">
                    <h4>Issue: Tool not appearing in ChatGPT</h4>
                    <p style="margin: 8px 0;"><strong>Causes:</strong></p>
                    <ul class="dense-list">
                        <li>Developer Mode not enabled</li>
                        <li>Connector not toggled in chat</li>
                        <li>Server not accessible via HTTPS</li>
                        <li>Metadata refresh needed</li>
                    </ul>
                    <p style="margin: 8px 0;"><strong>Solutions:</strong></p>
                    <pre><code># Check server is running
curl https://your-server.com/mcp

# Verify tool list
curl https://your-server.com/mcp -d '{"method":"tools/list"}'

# Refresh connector in ChatGPT settings
# Toggle off and on again</code></pre>
                </div>

                <div class="card">
                    <h4>Issue: Component not rendering</h4>
                    <p style="margin: 8px 0;"><strong>Causes:</strong></p>
                    <ul class="dense-list">
                        <li>URL in outputTemplate not accessible</li>
                        <li>CSP headers blocking resources</li>
                        <li>JavaScript errors in console</li>
                        <li>window.openai not available</li>
                    </ul>
                    <p style="margin: 8px 0;"><strong>Solutions:</strong></p>
                    <pre><code>// Add error boundaries
class ErrorBoundary extends React.Component {
  componentDidCatch(error) {
    console.error('Component error:', error);
  }
  render() {
    return this.props.children;
  }
}

// Debug window.openai availability
useEffect(() => {
  console.log('window.openai:', window.openai);
  console.log('toolOutput:', window.openai?.toolOutput);
}, []);</code></pre>
                </div>

                <div class="card">
                    <h4>Issue: Authentication loop</h4>
                    <p style="margin: 8px 0;"><strong>Causes:</strong></p>
                    <ul class="dense-list">
                        <li>Token verification failing</li>
                        <li>OAuth redirect URI mismatch</li>
                        <li>PKCE challenge not matching</li>
                    </ul>
                    <p style="margin: 8px 0;"><strong>Solutions:</strong></p>
                    <pre><code># Enable debug logging
import logging
logging.basicConfig(level=logging.DEBUG)

# Verify OAuth configuration
auth = AuthSettings(
    authorization_url="...",
    token_url="...",
    redirect_uri="https://chatgpt.com/aip/oauth/callback",
    client_id="...",
    pkce=True
)

# Log token details
@mcp.tool
def protected_tool(token: str):
    logger.debug(f"Token received: {token[:10]}...")
    # Implementation</code></pre>
                </div>

                <h3>Debugging Tools</h3>
                <div class="two-column-layout">
                    <div>
                        <h4>MCP Inspector</h4>
                        <pre><code># Install and run
npx @modelcontextprotocol/inspector

# Test specific endpoint
npx @modelcontextprotocol/inspector \
  --url https://your-server.com/mcp</code></pre>
                    </div>
                    <div>
                        <h4>Browser DevTools</h4>
                        <pre><code>// In component console
console.log(window.openai);

// Monitor messages
window.addEventListener('message', e => {
  console.log('Message:', e.data);
});</code></pre>
                    </div>
                </div>

                <h3>Logging Best Practices</h3>
                <pre><code>import logging
from fastmcp import FastMCP

# Configure structured logging
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)

logger = logging.getLogger(__name__)

mcp = FastMCP("Debug Server")

@mcp.tool
def debug_tool(input_data: dict) -> dict:
    """Tool with comprehensive logging."""

    # Log input
    logger.info("Tool invoked", extra={
        "tool": "debug_tool",
        "input": input_data
    })

    try:
        # Process
        result = process_data(input_data)

        # Log success
        logger.info("Tool succeeded", extra={
            "result_size": len(result)
        })

        return result

    except Exception as e:
        # Log error with full context
        logger.error("Tool failed", extra={
            "error": str(e),
            "input": input_data
        }, exc_info=True)
        raise

def process_data(data):
    return {"processed": True}</code></pre>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <div><span class="arrow">▶</span>10. FastMCP vs Other Frameworks <span class="badge">REFERENCE</span></div>
            </div>
            <div class="collapsible-content">
                <h3>Comparison Matrix</h3>
                <table>
                    <tr>
                        <th>Feature</th>
                        <th>FastMCP</th>
                        <th>Official Python SDK</th>
                        <th>TypeScript SDK</th>
                    </tr>
                    <tr>
                        <td>Language</td>
                        <td>Python</td>
                        <td>Python</td>
                        <td>TypeScript/JavaScript</td>
                    </tr>
                    <tr>
                        <td>Decorator API</td>
                        <td>✅ @mcp.tool</td>
                        <td>❌ Manual registration</td>
                        <td>❌ Manual registration</td>
                    </tr>
                    <tr>
                        <td>Auto Schema Gen</td>
                        <td>✅ From type hints</td>
                        <td>⚠️ Manual or Pydantic</td>
                        <td>⚠️ TypeScript types</td>
                    </tr>
                    <tr>
                        <td>HTTP Transport</td>
                        <td>✅ Built-in</td>
                        <td>✅ Configurable</td>
                        <td>✅ Configurable</td>
                    </tr>
                    <tr>
                        <td>SSE Support</td>
                        <td>✅</td>
                        <td>✅</td>
                        <td>✅</td>
                    </tr>
                    <tr>
                        <td>OAuth/Auth</td>
                        <td>✅ AuthSettings</td>
                        <td>⚠️ Manual impl</td>
                        <td>⚠️ Manual impl</td>
                    </tr>
                    <tr>
                        <td>Deployment Helpers</td>
                        <td>✅ FastMCP Cloud</td>
                        <td>❌</td>
                        <td>❌</td>
                    </tr>
                    <tr>
                        <td>Documentation Gen</td>
                        <td>✅ Auto from docstrings</td>
                        <td>⚠️ Manual</td>
                        <td>⚠️ Manual</td>
                    </tr>
                    <tr>
                        <td>Server Composition</td>
                        <td>✅</td>
                        <td>⚠️ Manual</td>
                        <td>⚠️ Manual</td>
                    </tr>
                    <tr>
                        <td>Learning Curve</td>
                        <td>Low</td>
                        <td>Medium</td>
                        <td>Medium</td>
                    </tr>
                </table>

                <h3>When to Use Each</h3>
                <div class="two-column-layout">
                    <div class="card priority">
                        <h4>Use FastMCP When:</h4>
                        <ul class="dense-list">
                            <li>Building in Python</li>
                            <li>Want rapid prototyping</li>
                            <li>Need auth out-of-box</li>
                            <li>Prefer decorator patterns</li>
                            <li>Want managed deployment</li>
                            <li>ChatGPT is primary target</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>Use Official SDKs When:</h4>
                        <ul class="dense-list">
                            <li>Need TypeScript/Node.js</li>
                            <li>Want full control</li>
                            <li>Custom transport needed</li>
                            <li>Multi-client support critical</li>
                            <li>Existing infra constraints</li>
                            <li>Advanced customization</li>
                        </ul>
                    </div>
                </div>

                <h3>Migration Path</h3>
                <pre><code># From Official SDK to FastMCP

# Before (Official SDK)
from mcp import Server, Tool

server = Server("my-server")

def roll_dice_handler(arguments):
    return random.randint(1, arguments.get("sides", 6))

server.register_tool(Tool(
    name="roll_dice",
    description="Roll a dice",
    parameters={
        "type": "object",
        "properties": {
            "sides": {"type": "integer", "default": 6}
        }
    },
    handler=roll_dice_handler
))

# After (FastMCP)
from fastmcp import FastMCP

mcp = FastMCP("my-server")

@mcp.tool
def roll_dice(sides: int = 6) -> int:
    """Roll a dice."""
    return random.randint(1, sides)

# 90% less code, automatic schema generation!</code></pre>
            </div>
        </div>

        <div class="collapsible">
            <div class="collapsible-header">
                <div><span class="arrow">▶</span>11. Resources & Next Steps <span class="badge">REFERENCE</span></div>
            </div>
            <div class="collapsible-content">
                <h3>Official Documentation</h3>
                <ul class="dense-list">
                    <li><strong>Apps SDK Docs:</strong> <a href="https://developers.openai.com/apps-sdk" target="_blank">developers.openai.com/apps-sdk</a></li>
                    <li><strong>FastMCP GitHub:</strong> <a href="https://github.com/jlowin/fastmcp" target="_blank">github.com/jlowin/fastmcp</a></li>
                    <li><strong>FastMCP Website:</strong> <a href="https://fastmcp.me" target="_blank">fastmcp.me</a></li>
                    <li><strong>MCP Specification:</strong> <a href="https://modelcontextprotocol.org" target="_blank">modelcontextprotocol.org</a></li>
                </ul>

                <h3>Example Repositories</h3>
                <ul class="dense-list">
                    <li><strong>Mosaic MCP:</strong> Media workflow examples - <a href="https://docs.usemosaic.ai/example-apps/mosaic-mcp-server" target="_blank">docs.usemosaic.ai</a></li>
                    <li><strong>FastMCP Examples:</strong> <a href="https://github.com/jlowin/fastmcp/tree/main/examples" target="_blank">github.com/jlowin/fastmcp/examples</a></li>
                    <li><strong>Apps SDK Examples:</strong> <a href="https://github.com/openai/apps-sdk-examples" target="_blank">github.com/openai/apps-sdk-examples</a></li>
                </ul>

                <h3>Community & Support</h3>
                <ul class="dense-list">
                    <li><strong>FastMCP Discord:</strong> Community support and discussions</li>
                    <li><strong>OpenAI Forum:</strong> Apps SDK section for technical questions</li>
                    <li><strong>Stack Overflow:</strong> Tag questions with <code>chatgpt-apps</code> and <code>fastmcp</code></li>
                </ul>

                <h3>Development Tools</h3>
                <div class="two-column-layout">
                    <div class="card">
                        <h4>Testing & Debugging</h4>
                        <ul class="dense-list">
                            <li>MCP Inspector (npx)</li>
                            <li>Postman for API testing</li>
                            <li>Chrome DevTools</li>
                            <li>ngrok for local tunneling</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>Deployment Platforms</h4>
                        <ul class="dense-list">
                            <li>FastMCP Cloud (managed)</li>
                            <li>Fly.io (recommended)</li>
                            <li>Render (easy setup)</li>
                            <li>Google Cloud Run</li>
                        </ul>
                    </div>
                </div>

                <h3>Learning Path</h3>
                <div class="mermaid">
graph LR
    A[Learn FastMCP Basics] --> B[Build Simple Tool]
    B --> C[Add Component UI]
    C --> D[Implement Auth]
    D --> E[Deploy to Production]
    E --> F[Monitor & Iterate]

    A --> |1-2 hours| B
    B --> |2-4 hours| C
    C --> |4-6 hours| D
    D --> |2-3 hours| E
    E --> |Ongoing| F

    style A fill:#FFD700,stroke:#8B0000,stroke-width:2px
    style F fill:#00A86B,stroke:#8B0000,stroke-width:2px
                </div>

                <h3>Quick Start Checklist</h3>
                <div class="card priority">
                    <ul class="dense-list">
                        <li>☐ Install FastMCP: <code>pip install fastmcp</code></li>
                        <li>☐ Create first tool with <code>@mcp.tool</code></li>
                        <li>☐ Test locally: <code>mcp.run()</code></li>
                        <li>☐ Install MCP Inspector: <code>npx @modelcontextprotocol/inspector</code></li>
                        <li>☐ Verify tool schema and execution</li>
                        <li>☐ Create React component (if needed)</li>
                        <li>☐ Deploy to HTTPS endpoint</li>
                        <li>☐ Enable Developer Mode in ChatGPT</li>
                        <li>☐ Add connector with your endpoint</li>
                        <li>☐ Test end-to-end in ChatGPT</li>
                    </ul>
                </div>

                <div class="divider"></div>

                <div class="note">
                    <strong>🎯 Your Next Step:</strong> Pick one of the real-world examples above (Weather, Tasks, or Visualization) and build it from scratch. Start with the tool, test it with MCP Inspector, then add a component if desired. Deploy to ngrok first for quick testing, then move to production hosting once working.
                </div>
            </div>
        </div>

    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#FFD700',
                primaryTextColor: '#2B2B2B',
                primaryBorderColor: '#8B0000',
                lineColor: '#8B0000',
                secondaryColor: '#F5F5DC',
                tertiaryColor: '#00A86B'
            }
        });

        // Collapsible functionality
        document.querySelectorAll('.collapsible-header').forEach(header => {
            header.addEventListener('click', () => {
                const collapsible = header.parentElement;
                collapsible.classList.toggle('open');
            });
        });

        function expandAll() {
            document.querySelectorAll('.collapsible').forEach(el => {
                el.classList.add('open');
            });
        }

        function collapseAll() {
            document.querySelectorAll('.collapsible').forEach(el => {
                el.classList.remove('open');
            });
        }

        // Auto-expand first section
        document.querySelector('.collapsible').classList.add('open');
    </script>
</body>
</html>